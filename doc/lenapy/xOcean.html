<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>lenapy.xOcean API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../lenapy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;lenapy</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#proprietes">proprietes</a>
            </li>
            <li>
                    <a class="function" href="#NoneType">NoneType</a>
            </li>
            <li>
                    <a class="class" href="#OceanSet">OceanSet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#OceanSet.__init__">OceanSet</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.oml_theta0_threshold">oml_theta0_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.oml_sigma0_threshold">oml_sigma0_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.temp">temp</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.PT">PT</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.CT">CT</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.psal">psal</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.SR">SR</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.SA">SA</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.P">P</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.rho">rho</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.sigma0">sigma0</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.Cp">Cp</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.heat">heat</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.slh">slh</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.ohc">ohc</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.ssl">ssl</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.ieeh">ieeh</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.gohc">gohc</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.gohc_TOA">gohc_TOA</a>
                        </li>
                        <li>
                                <a class="function" href="#OceanSet.ohc_above">ohc_above</a>
                        </li>
                        <li>
                                <a class="function" href="#OceanSet.gohc_above">gohc_above</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.ocean_depth">ocean_depth</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.mld_theta0">mld_theta0</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.mld_theta0minus_only">mld_theta0minus_only</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.mld_sigma0">mld_sigma0</a>
                        </li>
                        <li>
                                <a class="variable" href="#OceanSet.mld_sigma0var">mld_sigma0var</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#OceanArray">OceanArray</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#OceanArray.__init__">OceanArray</a>
                        </li>
                        <li>
                                <a class="function" href="#OceanArray.add_value_surface">add_value_surface</a>
                        </li>
                        <li>
                                <a class="function" href="#OceanArray.integ_depth">integ_depth</a>
                        </li>
                        <li>
                                <a class="function" href="#OceanArray.cum_integ_depth">cum_integ_depth</a>
                        </li>
                        <li>
                                <a class="function" href="#OceanArray.above">above</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../lenapy.html">lenapy</a><wbr>.xOcean    </h1>

                
                        <input id="mod-xOcean-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-xOcean-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">gsw</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">xGeo</span> <span class="k">as</span> <span class="n">xg</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="k">def</span> <span class="nf">proprietes</span><span class="p">(</span><span class="n">da</span><span class="p">,</span><span class="n">nom</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">unite</span><span class="p">):</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">nom</span><span class="p">)</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>    <span class="n">out</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>    <span class="n">out</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unite</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>    <span class="k">return</span> <span class="n">out</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="k">def</span> <span class="nf">NoneType</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataset_accessor</span><span class="p">(</span><span class="s2">&quot;xocean&quot;</span><span class="p">)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="k">class</span> <span class="nc">OceanSet</span><span class="p">(</span><span class="n">xg</span><span class="o">.</span><span class="n">GeoSet</span><span class="p">):</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">    This class extends any dataset to a xOcean object, that allows to access to any TEOS10 variable simply by calling the name of the variable through the xOcean interface.</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">    The initial dataset must contains the fields necessary to compute the output variable (ex : temperature and salinity to compute heat, heat to compute ohc,...)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    Availabe fields</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    ---------------</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    Temperatures : one of the three types of temperature must be present in the original dataset to perform derived computation.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">        temp  : in-situ temperature        </span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">        PT    : potential temperature     </span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">        CT    : conservative temperature </span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    Salinities :  one of the three types of salinities must be present in the original dataset to perform derived computation.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        psal  : practical salinity  </span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        SR    : relative salinity    </span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">        SA    : absolute salinity. If there is no location information (lat,lon), absolute salinity is returned equal to relative salinity</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    Physical properties :</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        P     : pressure. If location information is present, pressure is adjusted with regard to latitude, otherwise latitude is equal to 0</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">        Cp    : heat capacity</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        rho   : density</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        sigma0: potential density anomaly at 0 dbar</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    Heat content :</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">        heat  : specific heat content (J/m3)</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        ohc   : local ocean heat content (J/m²), it is heat integrated over the whole ocean depth</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        gohc  : global ocean heat content (J/m²), it is ohc averaged over latitude-longitude, excluding continents</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">        gohc_TOA: idem gohc, including continents (where ohc=0)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        ohc_above: idem ohc, where heat is integrated above a given depth</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        gohc_above: idem gohc, averaging ohc_above instead of ohc</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    Sea level :</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">        slh   : steric sea layer height anomaly (-), equal to (1. - rho/rhoref)</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">        ssl   : steric sea surface level anomaly (m), it is slh integrated over the whole ocean depth</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        ieeh  : integrated expansion efficiency oh heat (m/(J/m²)), it is (ssl/ohc)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">    Layer depth :</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">        ocean_depth  : maximum depth with non Nan values for temperature</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">        mld_theta0   : ocean mixed layer depth, defined by a temperature drop from 0.2°C wrt to -10m depth </span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        mld_sigma0   : ocean mixed layer depth, defined by a potential density increase of 0.03kg/m3 wrt to -10m depth</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        mld_sigma0var: ocean mixed layer depth, defined by a potential density equal to the potential density at -10m depth with a temperature dropped by 0.2°C</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">    Examples</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    --------</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">    &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    &gt;&gt;&gt;print(data)</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">    &lt;xarray.Dataset&gt;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    Dimensions:    (latitude: 180, longitude: 360, time: 156, depth: 41)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">    Coordinates:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">      * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">      * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">      * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">      * depth      (depth) float32 1.0 5.0 10.0 20.0 ... 1.7e+03 1.8e+03 2e+03</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    Data variables:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        temp       (time, latitude, longitude, depth) float32 dask.array&lt;chunksize=(1, 180, 360, 10), meta=np.ndarray&gt;</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">        SA         (time, latitude, longitude, depth) float32 dask.array&lt;chunksize=(1, 180, 360, 10), meta=np.ndarray&gt;</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">    &gt;&gt;&gt;mld=data.xocean.mld_sigma0</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">    &gt;&gt;&gt;print(data.xocean.ohc_above(mld))</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    &lt;xarray.DataArray &#39;ohc_above&#39; (time: 156, latitude: 180, longitude: 360)&gt;</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">    dask.array&lt;where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">    Coordinates:</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        depth      (time, latitude, longitude) float64 dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">      * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">      * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">      * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    Attributes:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        long_name:  Ocean heat content</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        units:      J/m²</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">    &gt;&gt;&gt;print(data.xocean.gohc)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">    &lt;xarray.DataArray &#39;gohc&#39; (time: 156)&gt;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">    dask.array&lt;truediv, shape=(156,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray&gt;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    Coordinates:</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">      * time     (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        depth    float32 1.0</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    Attributes:</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        long_name:  Global ocean heat content wrt to ocean surface area</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        units:      J/m²</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">    &quot;&quot;&quot;</span>    
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">)</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="s1">&#39;PT&#39;</span><span class="p">,</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span><span class="s1">&#39;psal&#39;</span><span class="p">,</span><span class="s1">&#39;SA&#39;</span><span class="p">,</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;sigma0&#39;</span><span class="p">,</span><span class="s1">&#39;Cp&#39;</span><span class="p">,</span><span class="s1">&#39;heat&#39;</span><span class="p">,</span><span class="s1">&#39;slh&#39;</span><span class="p">,</span><span class="s1">&#39;ohc&#39;</span><span class="p">,</span><span class="s1">&#39;ssl&#39;</span><span class="p">,</span><span class="s1">&#39;ieeh&#39;</span><span class="p">,</span><span class="s1">&#39;gohc&#39;</span><span class="p">,</span><span class="s1">&#39;eeh&#39;</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>                <span class="s1">&#39;ocean_depth&#39;</span><span class="p">,</span><span class="s1">&#39;mld_theta0&#39;</span><span class="p">,</span><span class="s1">&#39;mld_sigma0&#39;</span><span class="p">,</span><span class="s1">&#39;mld_sigma0var&#39;</span><span class="p">]</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">,</span><span class="n">f</span><span class="p">):</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="n">xarray_obj</span><span class="p">[</span><span class="n">f</span><span class="p">])</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>                
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heat_</span><span class="p">):</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>            <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CT_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PT_</span><span class="p">):</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;At least one temperature must be set (temp, CT or PT)&#39;</span><span class="p">)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>            <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SR_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="p">):</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;At least one salinity must be set (psal, SA or SR)&#39;</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="o">=</span><span class="mf">0.2</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">oml_sigma0_threshold</span><span class="o">=</span><span class="mf">0.03</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>    <span class="nd">@property</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="k">def</span> <span class="nf">temp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">temp_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">t_from_CT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>                          <span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="s1">&#39;In-situ temperature&#39;</span><span class="p">,</span><span class="s1">&#39;dgeC&#39;</span><span class="p">)</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="nd">@property</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="k">def</span> <span class="nf">PT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PT_</span><span class="p">):</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">PT_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">pt0_from_t</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                          <span class="s1">&#39;pt&#39;</span><span class="p">,</span><span class="s1">&#39;Potential temperature&#39;</span><span class="p">,</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PT_</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="nd">@property</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="c1"># Temperature conservative en fonction de la salinité absolue, temperature in-situ, et pression</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">CT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CT_</span><span class="p">):</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">CT_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">CT_from_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="p">),</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                          <span class="s1">&#39;CT&#39;</span><span class="p">,</span><span class="s1">&#39;Conservative temperature&#39;</span><span class="p">,</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>  <span class="c1"># degC</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT_</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>    <span class="nd">@property</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>    <span class="c1"># Salinité pratique</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">psal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="p">):</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>            <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA_</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span> <span class="ow">and</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="o">=</span><span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SP_from_SR</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SR</span><span class="p">),</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                          <span class="s1">&#39;psal&#39;</span><span class="p">,</span><span class="s1">&#39;Practical salinity&#39;</span><span class="p">,</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span> <span class="c1"># [g/kg]</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                                
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="o">=</span><span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SP_from_SA</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>                          <span class="s1">&#39;psal&#39;</span><span class="p">,</span><span class="s1">&#39;Practical salinity&#39;</span><span class="p">,</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span> <span class="c1"># [g/kg]</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>                                  
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">psal_</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>    
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>    <span class="nd">@property</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="c1"># Salinité relative, en fonction de la salinité pratique</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">SR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SR_</span><span class="p">):</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SR_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SR_from_SP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal</span><span class="p">),</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>                          <span class="s1">&#39;SR&#39;</span><span class="p">,</span><span class="s1">&#39;Relative salinity&#39;</span><span class="p">,</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span> <span class="c1"># [g/kg]</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SR_</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>    
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>    <span class="c1"># Salinité absolue, en fonction de la salinité relative, la pression, et la position</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>    <span class="nd">@property</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">SA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA_</span><span class="p">):</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span> <span class="ow">and</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">SA_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SA_from_SP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>                          <span class="s1">&#39;SA&#39;</span><span class="p">,</span><span class="s1">&#39;Absolute salinity&#39;</span><span class="p">,</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span> <span class="c1"># [g/kg]</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">SA_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SR</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SA_</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>    
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>    <span class="nd">@property</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="c1"># Pression en fonction de la profondeur et de la latitude</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>    <span class="k">def</span> <span class="nf">P</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P_</span><span class="p">):</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">P_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">p_from_z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">*-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>                                  <span class="s1">&#39;p_db&#39;</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="s1">&#39;dbar&#39;</span><span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">P_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">p_from_z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">*-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>                                  <span class="s1">&#39;p_db&#39;</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="s1">&#39;dbar&#39;</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">P_</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="nd">@property</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="c1"># Densité en fonction de la salinité absolue, la température conservative et la pression</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>    <span class="k">def</span> <span class="nf">rho</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho_</span><span class="p">):</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rho_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                          <span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="s1">&#39;kg/m3&#39;</span><span class="p">)</span> <span class="c1"># [kg/m3]</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>    
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>    <span class="nd">@property</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    <span class="c1"># Anomalie de densité potentielle à 0dbar en fonction de la salinité absolue et la température conservative</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>    <span class="k">def</span> <span class="nf">sigma0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma0_</span><span class="p">):</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sigma0_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">sigma0</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">),</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>                          <span class="s1">&#39;sigma0&#39;</span><span class="p">,</span><span class="s1">&#39;Potential Density Anomaly&#39;</span><span class="p">,</span><span class="s1">&#39;kg/m3&#39;</span><span class="p">)</span> <span class="c1"># [kg/m3]</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma0_</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>    <span class="nd">@property</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>    <span class="c1"># Capacité calorifique en fonction de la salinité absolue, la température in-situ et la pression</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">Cp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cp_</span><span class="p">):</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Cp_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">cp_t_exact</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                          <span class="s1">&#39;Cp&#39;</span><span class="p">,</span><span class="s1">&#39;Specific heat capacity&#39;</span><span class="p">,</span> <span class="s1">&#39;J/kg/degC&#39;</span><span class="p">)</span> <span class="c1"># [j/kg/degC)]</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cp_</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>    
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>    <span class="nd">@property</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>    <span class="c1"># Contenu en chaleur des couches en fonction de la densité, la capacité calorifique, et la température conservative</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>    <span class="k">def</span> <span class="nf">heat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heat_</span><span class="p">):</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">heat_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cp</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">),</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>                          <span class="s1">&#39;Heat&#39;</span><span class="p">,</span><span class="s1">&#39;Heat content&#39;</span><span class="p">,</span><span class="s1">&#39;J/m3&#39;</span><span class="p">)</span> <span class="c1"># [J/m3]</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">heat_</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>    
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>    <span class="nd">@property</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>    <span class="c1"># Anomalie relative de densité par rapport à une référence (0,35)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>    <span class="k">def</span> <span class="nf">slh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slh_</span><span class="p">):</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                <span class="n">rhoref</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SA_from_SP</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                                 <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                <span class="n">rhoref</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SR_from_SP</span><span class="p">(</span><span class="mi">35</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="k">return</span>  <span class="n">proprietes</span><span class="p">(((</span><span class="mf">1.</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="o">/</span><span class="n">rhoref</span><span class="p">)),</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                           <span class="s1">&#39;slh&#39;</span><span class="p">,</span><span class="s1">&#39;Steric sea layer height anomaly&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="c1"># [-]</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>    <span class="nd">@property</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>    <span class="c1"># Contenu en chaleur de la colonne</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>    <span class="k">def</span> <span class="nf">ohc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc_</span><span class="p">):</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ohc_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heat</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">integ_depth</span><span class="p">(),</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                          <span class="s1">&#39;ohc&#39;</span><span class="p">,</span><span class="s1">&#39;Ocean heat content&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span> <span class="c1"># [J/m²]</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohc_</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>    
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>    <span class="nd">@property</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="c1"># Ecart de hauteur d&#39;eau de la colonne par rapport à une référence (0,35)</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">ssl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_</span><span class="p">):</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ssl_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slh</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">integ_depth</span><span class="p">(),</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>                          <span class="s1">&#39;ssl&#39;</span><span class="p">,</span><span class="s1">&#39;Steric sea surface level anomaly&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">)</span> <span class="c1"># [m]</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssl_</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>    
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="nd">@property</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>    <span class="c1"># IEEH de la colonne (grandeur surfacique)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>    <span class="k">def</span> <span class="nf">ieeh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ieeh_</span><span class="p">):</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ieeh_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc</span><span class="p">,</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                          <span class="s1">&#39;IEEH&#39;</span><span class="p">,</span><span class="s1">&#39;Integrated expansion efficiency oh heat&#39;</span><span class="p">,</span><span class="s1">&#39;m/(J/m²)&#39;</span><span class="p">)</span> <span class="c1"># [m/(J/m²)]</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ieeh_</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    <span class="nd">@property</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="k">def</span> <span class="nf">gohc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]),</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                         <span class="s1">&#39;gohc&#39;</span><span class="p">,</span><span class="s1">&#39;Global ocean heat content wrt to ocean surface area&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>    <span class="nd">@property</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>    <span class="k">def</span> <span class="nf">gohc_TOA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>                         <span class="s1">&#39;gohc&#39;</span><span class="p">,</span><span class="s1">&#39;Global ocean heat content wrt to TOA area&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">ohc_above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>        <span class="n">res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">heat</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">above</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="o">!=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>            <span class="s1">&#39;ohc_above&#39;</span><span class="p">,</span><span class="s1">&#39;Ocean heat content&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span> <span class="c1"># [J/m²]</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>    <span class="k">def</span> <span class="nf">gohc_above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc_above</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="n">na_eq_zero</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">),</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>                         <span class="s1">&#39;gohc_above&#39;</span><span class="p">,</span><span class="s1">&#39;Global ocean heat content above target&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>    <span class="nd">@property</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>    <span class="k">def</span> <span class="nf">ocean_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth_</span><span class="p">):</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth_</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth_</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>        
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>    <span class="c1"># Profondeur de l&#39;Ocean Mixed Layer definie par une variation de temperature potentielle de 0.2°C par rapport à -10m</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>    <span class="nd">@property</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>    <span class="k">def</span> <span class="nf">mld_theta0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="n">theta0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="n">mld1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">theta0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="p">,</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="n">mld2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">theta0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="p">,</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="n">mld1</span><span class="o">=</span><span class="n">mld1</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mld2</span><span class="p">)</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="n">mld2</span><span class="o">=</span><span class="n">mld2</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mld1</span><span class="p">)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mld_theta0_</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mld2</span><span class="o">&lt;</span><span class="n">mld1</span><span class="p">,</span><span class="n">mld2</span><span class="p">,</span><span class="n">mld1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OMLD_theta0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mld_theta0_</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>    <span class="c1"># Profondeur de l&#39;Ocean Mixed Layer definie par une diminution de temperature potentielle de 0.2°C par rapport à -10m</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>    <span class="nd">@property</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>    <span class="k">def</span> <span class="nf">mld_theta0minus_only</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="n">theta0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mld_theta0_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">theta0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="p">,</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>            <span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OMLD_theta0minus_only&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth</span><span class="p">)</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mld_theta0_</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>    
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>    <span class="c1"># Profondeur de l&#39;Ocean Mixed Layer definie par une augmentation de densité potentielle de 0.03kg/m3 par rapport à -10m</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>    <span class="nd">@property</span>    
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>    <span class="k">def</span> <span class="nf">mld_sigma0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="n">sigma0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mld_sigma0_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">sigma0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_sigma0_threshold</span><span class="p">,</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>            <span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OMLD_sigma0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth</span><span class="p">)</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mld_sigma0_</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>    
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>    <span class="c1"># Profondeur de l&#39;Ocean Mixed Layer definie par une augmentation de densité potentielle correspondant à -0.2°C par rapport à -10m</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>    <span class="nd">@property</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>    <span class="k">def</span> <span class="nf">mld_sigma0var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="n">ref</span><span class="p">[</span><span class="s1">&#39;PT&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ref</span><span class="p">[</span><span class="s1">&#39;PT&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mld_sigma0var_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">),</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OMLD_sigma0var&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth</span><span class="p">)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mld_sigma0var_</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a> 
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataarray_accessor</span><span class="p">(</span><span class="s2">&quot;xocean&quot;</span><span class="p">)</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="k">class</span> <span class="nc">OceanArray</span><span class="p">(</span><span class="n">xg</span><span class="o">.</span><span class="n">GeoArray</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">    This class extends any dataarray to a xOcean object, to perform specific operations on structured dataarray </span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>    <span class="k">def</span> <span class="nf">add_value_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">        Add a surface layer with a specified value, or the previous upper value</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">        Parameter</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">        ---------</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">        value : float or array-like, optional</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">            values to be added in the surface layer (depth=0). If None, the previous upper value is used to fill the new layer</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">        </span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">        Returns</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">        -------</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">        added : DataArray</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">            new dataarray with a extra layer at depth 0 filled with required values</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="sd">            </span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a><span class="sd">        Example</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="sd">        -------</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">        &gt;&gt;&gt;heat=data.xocean.heat.xocean.add_value_surface()            </span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>            <span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="n">v0</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">v0</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>            <span class="k">if</span> <span class="n">value</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>                <span class="n">v0</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">v0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">],</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>                    
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>    <span class="k">def</span> <span class="nf">integ_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a><span class="sd">        Returns the dataarray integrated over the whole depth. The surface value is supposed equal to the most shallow value.</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="sd">        In order to deal with NaN values in deep water during integration,, all NaN are firt converted to 0, then in the output </span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">        array NaN values are applied where initial surface values were NaN.</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">        </span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">        Example</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">        -------</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.integ_depth()    </span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        &lt;xarray.DataArray &#39;Heat&#39; (time: 156, latitude: 180, longitude: 360)&gt;</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">        Coordinates:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">            depth      float32 1.0</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>    
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>    <span class="k">def</span> <span class="nf">cum_integ_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        Returns a cumulative integrated dataarray integrated over the whole depth. The surface value is supposed equal to the </span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        most shallow value. A first integration layer by layer is performed, by multupliying the layer&#39;s thickness by the mean</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">        value of upper and lower bound, then a cumulative sum is computed.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        </span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">        Example</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">        -------</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.cum_integ_depth()       </span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        &lt;xarray.DataArray (time: 156, latitude: 180, longitude: 360, depth: 41)&gt;</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360, 41), dtype=float64, chunksize=(1, 180, 360, 10), chunktype=numpy.ndarray&gt;</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        Coordinates:</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">          * depth      (depth) float64 1.0 5.0 10.0 20.0 ... 1.7e+03 1.8e+03 2e+03</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="n">res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">()</span>  
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="n">ep</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="n">vm</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">vm</span><span class="o">*</span><span class="n">ep</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>    
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        Returns the dataarray integrated above a given depth, by interpolating at this depth the cumulative integrale </span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        of the data array</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        Example</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        -------</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">        &gt;&gt;&gt;mld=data.xocean.mld_sigma0</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.above(mld)       </span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">        &lt;xarray.DataArray (time: 156, latitude: 180, longitude: 360)&gt;</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">        Coordinates:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">            depth      (time, latitude, longitude) float64 dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cum_integ_depth</span><span class="p">()</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">interp</span><span class="p">({</span><span class="s1">&#39;depth&#39;</span><span class="p">:</span><span class="n">depth</span><span class="p">},</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>    
</span></pre></div>


            </section>
                <section id="proprietes">
                            <input id="proprietes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">proprietes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">da</span>, </span><span class="param"><span class="n">nom</span>, </span><span class="param"><span class="n">label</span>, </span><span class="param"><span class="n">unite</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="proprietes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#proprietes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="proprietes-11"><a href="#proprietes-11"><span class="linenos">11</span></a><span class="k">def</span> <span class="nf">proprietes</span><span class="p">(</span><span class="n">da</span><span class="p">,</span><span class="n">nom</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">unite</span><span class="p">):</span>
</span><span id="proprietes-12"><a href="#proprietes-12"><span class="linenos">12</span></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">nom</span><span class="p">)</span>
</span><span id="proprietes-13"><a href="#proprietes-13"><span class="linenos">13</span></a>    <span class="n">out</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="proprietes-14"><a href="#proprietes-14"><span class="linenos">14</span></a>    <span class="n">out</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unite</span>
</span><span id="proprietes-15"><a href="#proprietes-15"><span class="linenos">15</span></a>    <span class="k">return</span> <span class="n">out</span>
</span></pre></div>


    

                </section>
                <section id="NoneType">
                            <input id="NoneType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">NoneType</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">var</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NoneType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NoneType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NoneType-17"><a href="#NoneType-17"><span class="linenos">17</span></a><span class="k">def</span> <span class="nf">NoneType</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
</span><span id="NoneType-18"><a href="#NoneType-18"><span class="linenos">18</span></a>    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="OceanSet">
                            <input id="OceanSet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@xr.register_dataset_accessor(&#39;xocean&#39;)</div>

    <span class="def">class</span>
    <span class="name">OceanSet</span><wbr>(<span class="base"><a href="xGeo.html#GeoSet">lenapy.xGeo.GeoSet</a></span>):

                <label class="view-source-button" for="OceanSet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanSet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanSet-20"><a href="#OceanSet-20"><span class="linenos"> 20</span></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataset_accessor</span><span class="p">(</span><span class="s2">&quot;xocean&quot;</span><span class="p">)</span>
</span><span id="OceanSet-21"><a href="#OceanSet-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">OceanSet</span><span class="p">(</span><span class="n">xg</span><span class="o">.</span><span class="n">GeoSet</span><span class="p">):</span>
</span><span id="OceanSet-22"><a href="#OceanSet-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="OceanSet-23"><a href="#OceanSet-23"><span class="linenos"> 23</span></a><span class="sd">    This class extends any dataset to a xOcean object, that allows to access to any TEOS10 variable simply by calling the name of the variable through the xOcean interface.</span>
</span><span id="OceanSet-24"><a href="#OceanSet-24"><span class="linenos"> 24</span></a><span class="sd">    The initial dataset must contains the fields necessary to compute the output variable (ex : temperature and salinity to compute heat, heat to compute ohc,...)</span>
</span><span id="OceanSet-25"><a href="#OceanSet-25"><span class="linenos"> 25</span></a>
</span><span id="OceanSet-26"><a href="#OceanSet-26"><span class="linenos"> 26</span></a><span class="sd">    Availabe fields</span>
</span><span id="OceanSet-27"><a href="#OceanSet-27"><span class="linenos"> 27</span></a><span class="sd">    ---------------</span>
</span><span id="OceanSet-28"><a href="#OceanSet-28"><span class="linenos"> 28</span></a><span class="sd">    Temperatures : one of the three types of temperature must be present in the original dataset to perform derived computation.</span>
</span><span id="OceanSet-29"><a href="#OceanSet-29"><span class="linenos"> 29</span></a><span class="sd">        temp  : in-situ temperature        </span>
</span><span id="OceanSet-30"><a href="#OceanSet-30"><span class="linenos"> 30</span></a><span class="sd">        PT    : potential temperature     </span>
</span><span id="OceanSet-31"><a href="#OceanSet-31"><span class="linenos"> 31</span></a><span class="sd">        CT    : conservative temperature </span>
</span><span id="OceanSet-32"><a href="#OceanSet-32"><span class="linenos"> 32</span></a>
</span><span id="OceanSet-33"><a href="#OceanSet-33"><span class="linenos"> 33</span></a><span class="sd">    Salinities :  one of the three types of salinities must be present in the original dataset to perform derived computation.</span>
</span><span id="OceanSet-34"><a href="#OceanSet-34"><span class="linenos"> 34</span></a><span class="sd">        psal  : practical salinity  </span>
</span><span id="OceanSet-35"><a href="#OceanSet-35"><span class="linenos"> 35</span></a><span class="sd">        SR    : relative salinity    </span>
</span><span id="OceanSet-36"><a href="#OceanSet-36"><span class="linenos"> 36</span></a><span class="sd">        SA    : absolute salinity. If there is no location information (lat,lon), absolute salinity is returned equal to relative salinity</span>
</span><span id="OceanSet-37"><a href="#OceanSet-37"><span class="linenos"> 37</span></a>
</span><span id="OceanSet-38"><a href="#OceanSet-38"><span class="linenos"> 38</span></a><span class="sd">    Physical properties :</span>
</span><span id="OceanSet-39"><a href="#OceanSet-39"><span class="linenos"> 39</span></a><span class="sd">        P     : pressure. If location information is present, pressure is adjusted with regard to latitude, otherwise latitude is equal to 0</span>
</span><span id="OceanSet-40"><a href="#OceanSet-40"><span class="linenos"> 40</span></a><span class="sd">        Cp    : heat capacity</span>
</span><span id="OceanSet-41"><a href="#OceanSet-41"><span class="linenos"> 41</span></a><span class="sd">        rho   : density</span>
</span><span id="OceanSet-42"><a href="#OceanSet-42"><span class="linenos"> 42</span></a><span class="sd">        sigma0: potential density anomaly at 0 dbar</span>
</span><span id="OceanSet-43"><a href="#OceanSet-43"><span class="linenos"> 43</span></a>
</span><span id="OceanSet-44"><a href="#OceanSet-44"><span class="linenos"> 44</span></a><span class="sd">    Heat content :</span>
</span><span id="OceanSet-45"><a href="#OceanSet-45"><span class="linenos"> 45</span></a><span class="sd">        heat  : specific heat content (J/m3)</span>
</span><span id="OceanSet-46"><a href="#OceanSet-46"><span class="linenos"> 46</span></a><span class="sd">        ohc   : local ocean heat content (J/m²), it is heat integrated over the whole ocean depth</span>
</span><span id="OceanSet-47"><a href="#OceanSet-47"><span class="linenos"> 47</span></a><span class="sd">        gohc  : global ocean heat content (J/m²), it is ohc averaged over latitude-longitude, excluding continents</span>
</span><span id="OceanSet-48"><a href="#OceanSet-48"><span class="linenos"> 48</span></a><span class="sd">        gohc_TOA: idem gohc, including continents (where ohc=0)</span>
</span><span id="OceanSet-49"><a href="#OceanSet-49"><span class="linenos"> 49</span></a><span class="sd">        ohc_above: idem ohc, where heat is integrated above a given depth</span>
</span><span id="OceanSet-50"><a href="#OceanSet-50"><span class="linenos"> 50</span></a><span class="sd">        gohc_above: idem gohc, averaging ohc_above instead of ohc</span>
</span><span id="OceanSet-51"><a href="#OceanSet-51"><span class="linenos"> 51</span></a>
</span><span id="OceanSet-52"><a href="#OceanSet-52"><span class="linenos"> 52</span></a><span class="sd">    Sea level :</span>
</span><span id="OceanSet-53"><a href="#OceanSet-53"><span class="linenos"> 53</span></a><span class="sd">        slh   : steric sea layer height anomaly (-), equal to (1. - rho/rhoref)</span>
</span><span id="OceanSet-54"><a href="#OceanSet-54"><span class="linenos"> 54</span></a><span class="sd">        ssl   : steric sea surface level anomaly (m), it is slh integrated over the whole ocean depth</span>
</span><span id="OceanSet-55"><a href="#OceanSet-55"><span class="linenos"> 55</span></a><span class="sd">        ieeh  : integrated expansion efficiency oh heat (m/(J/m²)), it is (ssl/ohc)</span>
</span><span id="OceanSet-56"><a href="#OceanSet-56"><span class="linenos"> 56</span></a>
</span><span id="OceanSet-57"><a href="#OceanSet-57"><span class="linenos"> 57</span></a><span class="sd">    Layer depth :</span>
</span><span id="OceanSet-58"><a href="#OceanSet-58"><span class="linenos"> 58</span></a><span class="sd">        ocean_depth  : maximum depth with non Nan values for temperature</span>
</span><span id="OceanSet-59"><a href="#OceanSet-59"><span class="linenos"> 59</span></a><span class="sd">        mld_theta0   : ocean mixed layer depth, defined by a temperature drop from 0.2°C wrt to -10m depth </span>
</span><span id="OceanSet-60"><a href="#OceanSet-60"><span class="linenos"> 60</span></a><span class="sd">        mld_sigma0   : ocean mixed layer depth, defined by a potential density increase of 0.03kg/m3 wrt to -10m depth</span>
</span><span id="OceanSet-61"><a href="#OceanSet-61"><span class="linenos"> 61</span></a><span class="sd">        mld_sigma0var: ocean mixed layer depth, defined by a potential density equal to the potential density at -10m depth with a temperature dropped by 0.2°C</span>
</span><span id="OceanSet-62"><a href="#OceanSet-62"><span class="linenos"> 62</span></a>
</span><span id="OceanSet-63"><a href="#OceanSet-63"><span class="linenos"> 63</span></a><span class="sd">    Examples</span>
</span><span id="OceanSet-64"><a href="#OceanSet-64"><span class="linenos"> 64</span></a><span class="sd">    --------</span>
</span><span id="OceanSet-65"><a href="#OceanSet-65"><span class="linenos"> 65</span></a><span class="sd">    &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanSet-66"><a href="#OceanSet-66"><span class="linenos"> 66</span></a><span class="sd">    &gt;&gt;&gt;print(data)</span>
</span><span id="OceanSet-67"><a href="#OceanSet-67"><span class="linenos"> 67</span></a><span class="sd">    &lt;xarray.Dataset&gt;</span>
</span><span id="OceanSet-68"><a href="#OceanSet-68"><span class="linenos"> 68</span></a><span class="sd">    Dimensions:    (latitude: 180, longitude: 360, time: 156, depth: 41)</span>
</span><span id="OceanSet-69"><a href="#OceanSet-69"><span class="linenos"> 69</span></a><span class="sd">    Coordinates:</span>
</span><span id="OceanSet-70"><a href="#OceanSet-70"><span class="linenos"> 70</span></a><span class="sd">      * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="OceanSet-71"><a href="#OceanSet-71"><span class="linenos"> 71</span></a><span class="sd">      * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="OceanSet-72"><a href="#OceanSet-72"><span class="linenos"> 72</span></a><span class="sd">      * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanSet-73"><a href="#OceanSet-73"><span class="linenos"> 73</span></a><span class="sd">      * depth      (depth) float32 1.0 5.0 10.0 20.0 ... 1.7e+03 1.8e+03 2e+03</span>
</span><span id="OceanSet-74"><a href="#OceanSet-74"><span class="linenos"> 74</span></a><span class="sd">    Data variables:</span>
</span><span id="OceanSet-75"><a href="#OceanSet-75"><span class="linenos"> 75</span></a><span class="sd">        temp       (time, latitude, longitude, depth) float32 dask.array&lt;chunksize=(1, 180, 360, 10), meta=np.ndarray&gt;</span>
</span><span id="OceanSet-76"><a href="#OceanSet-76"><span class="linenos"> 76</span></a><span class="sd">        SA         (time, latitude, longitude, depth) float32 dask.array&lt;chunksize=(1, 180, 360, 10), meta=np.ndarray&gt;</span>
</span><span id="OceanSet-77"><a href="#OceanSet-77"><span class="linenos"> 77</span></a><span class="sd">    &gt;&gt;&gt;mld=data.xocean.mld_sigma0</span>
</span><span id="OceanSet-78"><a href="#OceanSet-78"><span class="linenos"> 78</span></a><span class="sd">    &gt;&gt;&gt;print(data.xocean.ohc_above(mld))</span>
</span><span id="OceanSet-79"><a href="#OceanSet-79"><span class="linenos"> 79</span></a><span class="sd">    &lt;xarray.DataArray &#39;ohc_above&#39; (time: 156, latitude: 180, longitude: 360)&gt;</span>
</span><span id="OceanSet-80"><a href="#OceanSet-80"><span class="linenos"> 80</span></a><span class="sd">    dask.array&lt;where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;</span>
</span><span id="OceanSet-81"><a href="#OceanSet-81"><span class="linenos"> 81</span></a><span class="sd">    Coordinates:</span>
</span><span id="OceanSet-82"><a href="#OceanSet-82"><span class="linenos"> 82</span></a><span class="sd">        depth      (time, latitude, longitude) float64 dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</span>
</span><span id="OceanSet-83"><a href="#OceanSet-83"><span class="linenos"> 83</span></a><span class="sd">      * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanSet-84"><a href="#OceanSet-84"><span class="linenos"> 84</span></a><span class="sd">      * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="OceanSet-85"><a href="#OceanSet-85"><span class="linenos"> 85</span></a><span class="sd">      * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="OceanSet-86"><a href="#OceanSet-86"><span class="linenos"> 86</span></a><span class="sd">    Attributes:</span>
</span><span id="OceanSet-87"><a href="#OceanSet-87"><span class="linenos"> 87</span></a><span class="sd">        long_name:  Ocean heat content</span>
</span><span id="OceanSet-88"><a href="#OceanSet-88"><span class="linenos"> 88</span></a><span class="sd">        units:      J/m²</span>
</span><span id="OceanSet-89"><a href="#OceanSet-89"><span class="linenos"> 89</span></a><span class="sd">    &gt;&gt;&gt;print(data.xocean.gohc)</span>
</span><span id="OceanSet-90"><a href="#OceanSet-90"><span class="linenos"> 90</span></a><span class="sd">    &lt;xarray.DataArray &#39;gohc&#39; (time: 156)&gt;</span>
</span><span id="OceanSet-91"><a href="#OceanSet-91"><span class="linenos"> 91</span></a><span class="sd">    dask.array&lt;truediv, shape=(156,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray&gt;</span>
</span><span id="OceanSet-92"><a href="#OceanSet-92"><span class="linenos"> 92</span></a><span class="sd">    Coordinates:</span>
</span><span id="OceanSet-93"><a href="#OceanSet-93"><span class="linenos"> 93</span></a><span class="sd">      * time     (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanSet-94"><a href="#OceanSet-94"><span class="linenos"> 94</span></a><span class="sd">        depth    float32 1.0</span>
</span><span id="OceanSet-95"><a href="#OceanSet-95"><span class="linenos"> 95</span></a><span class="sd">    Attributes:</span>
</span><span id="OceanSet-96"><a href="#OceanSet-96"><span class="linenos"> 96</span></a><span class="sd">        long_name:  Global ocean heat content wrt to ocean surface area</span>
</span><span id="OceanSet-97"><a href="#OceanSet-97"><span class="linenos"> 97</span></a><span class="sd">        units:      J/m²</span>
</span><span id="OceanSet-98"><a href="#OceanSet-98"><span class="linenos"> 98</span></a><span class="sd">    &quot;&quot;&quot;</span>    
</span><span id="OceanSet-99"><a href="#OceanSet-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="OceanSet-100"><a href="#OceanSet-100"><span class="linenos">100</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">)</span>
</span><span id="OceanSet-101"><a href="#OceanSet-101"><span class="linenos">101</span></a>        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="s1">&#39;PT&#39;</span><span class="p">,</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span><span class="s1">&#39;psal&#39;</span><span class="p">,</span><span class="s1">&#39;SA&#39;</span><span class="p">,</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;sigma0&#39;</span><span class="p">,</span><span class="s1">&#39;Cp&#39;</span><span class="p">,</span><span class="s1">&#39;heat&#39;</span><span class="p">,</span><span class="s1">&#39;slh&#39;</span><span class="p">,</span><span class="s1">&#39;ohc&#39;</span><span class="p">,</span><span class="s1">&#39;ssl&#39;</span><span class="p">,</span><span class="s1">&#39;ieeh&#39;</span><span class="p">,</span><span class="s1">&#39;gohc&#39;</span><span class="p">,</span><span class="s1">&#39;eeh&#39;</span><span class="p">,</span>
</span><span id="OceanSet-102"><a href="#OceanSet-102"><span class="linenos">102</span></a>                <span class="s1">&#39;ocean_depth&#39;</span><span class="p">,</span><span class="s1">&#39;mld_theta0&#39;</span><span class="p">,</span><span class="s1">&#39;mld_sigma0&#39;</span><span class="p">,</span><span class="s1">&#39;mld_sigma0var&#39;</span><span class="p">]</span>
</span><span id="OceanSet-103"><a href="#OceanSet-103"><span class="linenos">103</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
</span><span id="OceanSet-104"><a href="#OceanSet-104"><span class="linenos">104</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">,</span><span class="n">f</span><span class="p">):</span>
</span><span id="OceanSet-105"><a href="#OceanSet-105"><span class="linenos">105</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="n">xarray_obj</span><span class="p">[</span><span class="n">f</span><span class="p">])</span>
</span><span id="OceanSet-106"><a href="#OceanSet-106"><span class="linenos">106</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="OceanSet-107"><a href="#OceanSet-107"><span class="linenos">107</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
</span><span id="OceanSet-108"><a href="#OceanSet-108"><span class="linenos">108</span></a>                
</span><span id="OceanSet-109"><a href="#OceanSet-109"><span class="linenos">109</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heat_</span><span class="p">):</span>
</span><span id="OceanSet-110"><a href="#OceanSet-110"><span class="linenos">110</span></a>            <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CT_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PT_</span><span class="p">):</span>
</span><span id="OceanSet-111"><a href="#OceanSet-111"><span class="linenos">111</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;At least one temperature must be set (temp, CT or PT)&#39;</span><span class="p">)</span>
</span><span id="OceanSet-112"><a href="#OceanSet-112"><span class="linenos">112</span></a>            <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SR_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="p">):</span>
</span><span id="OceanSet-113"><a href="#OceanSet-113"><span class="linenos">113</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;At least one salinity must be set (psal, SA or SR)&#39;</span><span class="p">)</span>
</span><span id="OceanSet-114"><a href="#OceanSet-114"><span class="linenos">114</span></a>
</span><span id="OceanSet-115"><a href="#OceanSet-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="o">=</span><span class="mf">0.2</span>
</span><span id="OceanSet-116"><a href="#OceanSet-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">oml_sigma0_threshold</span><span class="o">=</span><span class="mf">0.03</span>
</span><span id="OceanSet-117"><a href="#OceanSet-117"><span class="linenos">117</span></a>
</span><span id="OceanSet-118"><a href="#OceanSet-118"><span class="linenos">118</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-119"><a href="#OceanSet-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">temp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-120"><a href="#OceanSet-120"><span class="linenos">120</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_</span><span class="p">):</span>
</span><span id="OceanSet-121"><a href="#OceanSet-121"><span class="linenos">121</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">temp_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">t_from_CT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span>
</span><span id="OceanSet-122"><a href="#OceanSet-122"><span class="linenos">122</span></a>                          <span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="s1">&#39;In-situ temperature&#39;</span><span class="p">,</span><span class="s1">&#39;dgeC&#39;</span><span class="p">)</span>
</span><span id="OceanSet-123"><a href="#OceanSet-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_</span>
</span><span id="OceanSet-124"><a href="#OceanSet-124"><span class="linenos">124</span></a>
</span><span id="OceanSet-125"><a href="#OceanSet-125"><span class="linenos">125</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-126"><a href="#OceanSet-126"><span class="linenos">126</span></a>    <span class="k">def</span> <span class="nf">PT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-127"><a href="#OceanSet-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PT_</span><span class="p">):</span>
</span><span id="OceanSet-128"><a href="#OceanSet-128"><span class="linenos">128</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">PT_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">pt0_from_t</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span>
</span><span id="OceanSet-129"><a href="#OceanSet-129"><span class="linenos">129</span></a>                          <span class="s1">&#39;pt&#39;</span><span class="p">,</span><span class="s1">&#39;Potential temperature&#39;</span><span class="p">,</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>
</span><span id="OceanSet-130"><a href="#OceanSet-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PT_</span>
</span><span id="OceanSet-131"><a href="#OceanSet-131"><span class="linenos">131</span></a>
</span><span id="OceanSet-132"><a href="#OceanSet-132"><span class="linenos">132</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-133"><a href="#OceanSet-133"><span class="linenos">133</span></a>    <span class="c1"># Temperature conservative en fonction de la salinité absolue, temperature in-situ, et pression</span>
</span><span id="OceanSet-134"><a href="#OceanSet-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">CT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-135"><a href="#OceanSet-135"><span class="linenos">135</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CT_</span><span class="p">):</span>
</span><span id="OceanSet-136"><a href="#OceanSet-136"><span class="linenos">136</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">CT_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">CT_from_pt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="p">),</span>
</span><span id="OceanSet-137"><a href="#OceanSet-137"><span class="linenos">137</span></a>                          <span class="s1">&#39;CT&#39;</span><span class="p">,</span><span class="s1">&#39;Conservative temperature&#39;</span><span class="p">,</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>  <span class="c1"># degC</span>
</span><span id="OceanSet-138"><a href="#OceanSet-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT_</span>
</span><span id="OceanSet-139"><a href="#OceanSet-139"><span class="linenos">139</span></a>    
</span><span id="OceanSet-140"><a href="#OceanSet-140"><span class="linenos">140</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-141"><a href="#OceanSet-141"><span class="linenos">141</span></a>    <span class="c1"># Salinité pratique</span>
</span><span id="OceanSet-142"><a href="#OceanSet-142"><span class="linenos">142</span></a>    <span class="k">def</span> <span class="nf">psal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-143"><a href="#OceanSet-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="p">):</span>
</span><span id="OceanSet-144"><a href="#OceanSet-144"><span class="linenos">144</span></a>            <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA_</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span> <span class="ow">and</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="OceanSet-145"><a href="#OceanSet-145"><span class="linenos">145</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="o">=</span><span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SP_from_SR</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SR</span><span class="p">),</span>
</span><span id="OceanSet-146"><a href="#OceanSet-146"><span class="linenos">146</span></a>                          <span class="s1">&#39;psal&#39;</span><span class="p">,</span><span class="s1">&#39;Practical salinity&#39;</span><span class="p">,</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span> <span class="c1"># [g/kg]</span>
</span><span id="OceanSet-147"><a href="#OceanSet-147"><span class="linenos">147</span></a>                                
</span><span id="OceanSet-148"><a href="#OceanSet-148"><span class="linenos">148</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="OceanSet-149"><a href="#OceanSet-149"><span class="linenos">149</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="o">=</span><span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SP_from_SA</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
</span><span id="OceanSet-150"><a href="#OceanSet-150"><span class="linenos">150</span></a>                          <span class="s1">&#39;psal&#39;</span><span class="p">,</span><span class="s1">&#39;Practical salinity&#39;</span><span class="p">,</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span> <span class="c1"># [g/kg]</span>
</span><span id="OceanSet-151"><a href="#OceanSet-151"><span class="linenos">151</span></a>                                  
</span><span id="OceanSet-152"><a href="#OceanSet-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">psal_</span>
</span><span id="OceanSet-153"><a href="#OceanSet-153"><span class="linenos">153</span></a>    
</span><span id="OceanSet-154"><a href="#OceanSet-154"><span class="linenos">154</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-155"><a href="#OceanSet-155"><span class="linenos">155</span></a>    <span class="c1"># Salinité relative, en fonction de la salinité pratique</span>
</span><span id="OceanSet-156"><a href="#OceanSet-156"><span class="linenos">156</span></a>    <span class="k">def</span> <span class="nf">SR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-157"><a href="#OceanSet-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SR_</span><span class="p">):</span>
</span><span id="OceanSet-158"><a href="#OceanSet-158"><span class="linenos">158</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SR_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SR_from_SP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal</span><span class="p">),</span>
</span><span id="OceanSet-159"><a href="#OceanSet-159"><span class="linenos">159</span></a>                          <span class="s1">&#39;SR&#39;</span><span class="p">,</span><span class="s1">&#39;Relative salinity&#39;</span><span class="p">,</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span> <span class="c1"># [g/kg]</span>
</span><span id="OceanSet-160"><a href="#OceanSet-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SR_</span>
</span><span id="OceanSet-161"><a href="#OceanSet-161"><span class="linenos">161</span></a>    
</span><span id="OceanSet-162"><a href="#OceanSet-162"><span class="linenos">162</span></a>    <span class="c1"># Salinité absolue, en fonction de la salinité relative, la pression, et la position</span>
</span><span id="OceanSet-163"><a href="#OceanSet-163"><span class="linenos">163</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-164"><a href="#OceanSet-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">SA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-165"><a href="#OceanSet-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA_</span><span class="p">):</span>
</span><span id="OceanSet-166"><a href="#OceanSet-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span> <span class="ow">and</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="OceanSet-167"><a href="#OceanSet-167"><span class="linenos">167</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">SA_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SA_from_SP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
</span><span id="OceanSet-168"><a href="#OceanSet-168"><span class="linenos">168</span></a>                          <span class="s1">&#39;SA&#39;</span><span class="p">,</span><span class="s1">&#39;Absolute salinity&#39;</span><span class="p">,</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span> <span class="c1"># [g/kg]</span>
</span><span id="OceanSet-169"><a href="#OceanSet-169"><span class="linenos">169</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="OceanSet-170"><a href="#OceanSet-170"><span class="linenos">170</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">SA_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SR</span>
</span><span id="OceanSet-171"><a href="#OceanSet-171"><span class="linenos">171</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SA_</span>
</span><span id="OceanSet-172"><a href="#OceanSet-172"><span class="linenos">172</span></a>    
</span><span id="OceanSet-173"><a href="#OceanSet-173"><span class="linenos">173</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-174"><a href="#OceanSet-174"><span class="linenos">174</span></a>    <span class="c1"># Pression en fonction de la profondeur et de la latitude</span>
</span><span id="OceanSet-175"><a href="#OceanSet-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">P</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-176"><a href="#OceanSet-176"><span class="linenos">176</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P_</span><span class="p">):</span>
</span><span id="OceanSet-177"><a href="#OceanSet-177"><span class="linenos">177</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="OceanSet-178"><a href="#OceanSet-178"><span class="linenos">178</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">P_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">p_from_z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">*-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
</span><span id="OceanSet-179"><a href="#OceanSet-179"><span class="linenos">179</span></a>                                  <span class="s1">&#39;p_db&#39;</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="s1">&#39;dbar&#39;</span><span class="p">)</span>
</span><span id="OceanSet-180"><a href="#OceanSet-180"><span class="linenos">180</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="OceanSet-181"><a href="#OceanSet-181"><span class="linenos">181</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">P_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">p_from_z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">*-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="OceanSet-182"><a href="#OceanSet-182"><span class="linenos">182</span></a>                                  <span class="s1">&#39;p_db&#39;</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="s1">&#39;dbar&#39;</span><span class="p">)</span>
</span><span id="OceanSet-183"><a href="#OceanSet-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">P_</span>
</span><span id="OceanSet-184"><a href="#OceanSet-184"><span class="linenos">184</span></a>
</span><span id="OceanSet-185"><a href="#OceanSet-185"><span class="linenos">185</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-186"><a href="#OceanSet-186"><span class="linenos">186</span></a>    <span class="c1"># Densité en fonction de la salinité absolue, la température conservative et la pression</span>
</span><span id="OceanSet-187"><a href="#OceanSet-187"><span class="linenos">187</span></a>    <span class="k">def</span> <span class="nf">rho</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-188"><a href="#OceanSet-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho_</span><span class="p">):</span>
</span><span id="OceanSet-189"><a href="#OceanSet-189"><span class="linenos">189</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rho_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span>
</span><span id="OceanSet-190"><a href="#OceanSet-190"><span class="linenos">190</span></a>                          <span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="s1">&#39;kg/m3&#39;</span><span class="p">)</span> <span class="c1"># [kg/m3]</span>
</span><span id="OceanSet-191"><a href="#OceanSet-191"><span class="linenos">191</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_</span>
</span><span id="OceanSet-192"><a href="#OceanSet-192"><span class="linenos">192</span></a>    
</span><span id="OceanSet-193"><a href="#OceanSet-193"><span class="linenos">193</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-194"><a href="#OceanSet-194"><span class="linenos">194</span></a>    <span class="c1"># Anomalie de densité potentielle à 0dbar en fonction de la salinité absolue et la température conservative</span>
</span><span id="OceanSet-195"><a href="#OceanSet-195"><span class="linenos">195</span></a>    <span class="k">def</span> <span class="nf">sigma0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-196"><a href="#OceanSet-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma0_</span><span class="p">):</span>
</span><span id="OceanSet-197"><a href="#OceanSet-197"><span class="linenos">197</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sigma0_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">sigma0</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">),</span>
</span><span id="OceanSet-198"><a href="#OceanSet-198"><span class="linenos">198</span></a>                          <span class="s1">&#39;sigma0&#39;</span><span class="p">,</span><span class="s1">&#39;Potential Density Anomaly&#39;</span><span class="p">,</span><span class="s1">&#39;kg/m3&#39;</span><span class="p">)</span> <span class="c1"># [kg/m3]</span>
</span><span id="OceanSet-199"><a href="#OceanSet-199"><span class="linenos">199</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma0_</span>
</span><span id="OceanSet-200"><a href="#OceanSet-200"><span class="linenos">200</span></a>    
</span><span id="OceanSet-201"><a href="#OceanSet-201"><span class="linenos">201</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-202"><a href="#OceanSet-202"><span class="linenos">202</span></a>    <span class="c1"># Capacité calorifique en fonction de la salinité absolue, la température in-situ et la pression</span>
</span><span id="OceanSet-203"><a href="#OceanSet-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">Cp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-204"><a href="#OceanSet-204"><span class="linenos">204</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cp_</span><span class="p">):</span>
</span><span id="OceanSet-205"><a href="#OceanSet-205"><span class="linenos">205</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Cp_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">cp_t_exact</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span>
</span><span id="OceanSet-206"><a href="#OceanSet-206"><span class="linenos">206</span></a>                          <span class="s1">&#39;Cp&#39;</span><span class="p">,</span><span class="s1">&#39;Specific heat capacity&#39;</span><span class="p">,</span> <span class="s1">&#39;J/kg/degC&#39;</span><span class="p">)</span> <span class="c1"># [j/kg/degC)]</span>
</span><span id="OceanSet-207"><a href="#OceanSet-207"><span class="linenos">207</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cp_</span>
</span><span id="OceanSet-208"><a href="#OceanSet-208"><span class="linenos">208</span></a>    
</span><span id="OceanSet-209"><a href="#OceanSet-209"><span class="linenos">209</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-210"><a href="#OceanSet-210"><span class="linenos">210</span></a>    <span class="c1"># Contenu en chaleur des couches en fonction de la densité, la capacité calorifique, et la température conservative</span>
</span><span id="OceanSet-211"><a href="#OceanSet-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">heat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-212"><a href="#OceanSet-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heat_</span><span class="p">):</span>
</span><span id="OceanSet-213"><a href="#OceanSet-213"><span class="linenos">213</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">heat_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cp</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">CT</span><span class="p">),</span>
</span><span id="OceanSet-214"><a href="#OceanSet-214"><span class="linenos">214</span></a>                          <span class="s1">&#39;Heat&#39;</span><span class="p">,</span><span class="s1">&#39;Heat content&#39;</span><span class="p">,</span><span class="s1">&#39;J/m3&#39;</span><span class="p">)</span> <span class="c1"># [J/m3]</span>
</span><span id="OceanSet-215"><a href="#OceanSet-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">heat_</span>
</span><span id="OceanSet-216"><a href="#OceanSet-216"><span class="linenos">216</span></a>    
</span><span id="OceanSet-217"><a href="#OceanSet-217"><span class="linenos">217</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-218"><a href="#OceanSet-218"><span class="linenos">218</span></a>    <span class="c1"># Anomalie relative de densité par rapport à une référence (0,35)</span>
</span><span id="OceanSet-219"><a href="#OceanSet-219"><span class="linenos">219</span></a>    <span class="k">def</span> <span class="nf">slh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-220"><a href="#OceanSet-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slh_</span><span class="p">):</span>
</span><span id="OceanSet-221"><a href="#OceanSet-221"><span class="linenos">221</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="OceanSet-222"><a href="#OceanSet-222"><span class="linenos">222</span></a>                <span class="n">rhoref</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SA_from_SP</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
</span><span id="OceanSet-223"><a href="#OceanSet-223"><span class="linenos">223</span></a>                                 <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
</span><span id="OceanSet-224"><a href="#OceanSet-224"><span class="linenos">224</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="OceanSet-225"><a href="#OceanSet-225"><span class="linenos">225</span></a>                <span class="n">rhoref</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">gsw</span><span class="o">.</span><span class="n">SR_from_SP</span><span class="p">(</span><span class="mi">35</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
</span><span id="OceanSet-226"><a href="#OceanSet-226"><span class="linenos">226</span></a>        <span class="k">return</span>  <span class="n">proprietes</span><span class="p">(((</span><span class="mf">1.</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="o">/</span><span class="n">rhoref</span><span class="p">)),</span>
</span><span id="OceanSet-227"><a href="#OceanSet-227"><span class="linenos">227</span></a>                           <span class="s1">&#39;slh&#39;</span><span class="p">,</span><span class="s1">&#39;Steric sea layer height anomaly&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="c1"># [-]</span>
</span><span id="OceanSet-228"><a href="#OceanSet-228"><span class="linenos">228</span></a>    
</span><span id="OceanSet-229"><a href="#OceanSet-229"><span class="linenos">229</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-230"><a href="#OceanSet-230"><span class="linenos">230</span></a>    <span class="c1"># Contenu en chaleur de la colonne</span>
</span><span id="OceanSet-231"><a href="#OceanSet-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">ohc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-232"><a href="#OceanSet-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc_</span><span class="p">):</span>
</span><span id="OceanSet-233"><a href="#OceanSet-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ohc_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heat</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">integ_depth</span><span class="p">(),</span>
</span><span id="OceanSet-234"><a href="#OceanSet-234"><span class="linenos">234</span></a>                          <span class="s1">&#39;ohc&#39;</span><span class="p">,</span><span class="s1">&#39;Ocean heat content&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span> <span class="c1"># [J/m²]</span>
</span><span id="OceanSet-235"><a href="#OceanSet-235"><span class="linenos">235</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohc_</span>
</span><span id="OceanSet-236"><a href="#OceanSet-236"><span class="linenos">236</span></a>    
</span><span id="OceanSet-237"><a href="#OceanSet-237"><span class="linenos">237</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-238"><a href="#OceanSet-238"><span class="linenos">238</span></a>    <span class="c1"># Ecart de hauteur d&#39;eau de la colonne par rapport à une référence (0,35)</span>
</span><span id="OceanSet-239"><a href="#OceanSet-239"><span class="linenos">239</span></a>    <span class="k">def</span> <span class="nf">ssl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-240"><a href="#OceanSet-240"><span class="linenos">240</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_</span><span class="p">):</span>
</span><span id="OceanSet-241"><a href="#OceanSet-241"><span class="linenos">241</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ssl_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slh</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">integ_depth</span><span class="p">(),</span>
</span><span id="OceanSet-242"><a href="#OceanSet-242"><span class="linenos">242</span></a>                          <span class="s1">&#39;ssl&#39;</span><span class="p">,</span><span class="s1">&#39;Steric sea surface level anomaly&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">)</span> <span class="c1"># [m]</span>
</span><span id="OceanSet-243"><a href="#OceanSet-243"><span class="linenos">243</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssl_</span>
</span><span id="OceanSet-244"><a href="#OceanSet-244"><span class="linenos">244</span></a>    
</span><span id="OceanSet-245"><a href="#OceanSet-245"><span class="linenos">245</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-246"><a href="#OceanSet-246"><span class="linenos">246</span></a>    <span class="c1"># IEEH de la colonne (grandeur surfacique)</span>
</span><span id="OceanSet-247"><a href="#OceanSet-247"><span class="linenos">247</span></a>    <span class="k">def</span> <span class="nf">ieeh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-248"><a href="#OceanSet-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ieeh_</span><span class="p">):</span>
</span><span id="OceanSet-249"><a href="#OceanSet-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ieeh_</span> <span class="o">=</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc</span><span class="p">,</span>
</span><span id="OceanSet-250"><a href="#OceanSet-250"><span class="linenos">250</span></a>                          <span class="s1">&#39;IEEH&#39;</span><span class="p">,</span><span class="s1">&#39;Integrated expansion efficiency oh heat&#39;</span><span class="p">,</span><span class="s1">&#39;m/(J/m²)&#39;</span><span class="p">)</span> <span class="c1"># [m/(J/m²)]</span>
</span><span id="OceanSet-251"><a href="#OceanSet-251"><span class="linenos">251</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ieeh_</span>
</span><span id="OceanSet-252"><a href="#OceanSet-252"><span class="linenos">252</span></a>
</span><span id="OceanSet-253"><a href="#OceanSet-253"><span class="linenos">253</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-254"><a href="#OceanSet-254"><span class="linenos">254</span></a>    <span class="k">def</span> <span class="nf">gohc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-255"><a href="#OceanSet-255"><span class="linenos">255</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]),</span>
</span><span id="OceanSet-256"><a href="#OceanSet-256"><span class="linenos">256</span></a>                         <span class="s1">&#39;gohc&#39;</span><span class="p">,</span><span class="s1">&#39;Global ocean heat content wrt to ocean surface area&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span>
</span><span id="OceanSet-257"><a href="#OceanSet-257"><span class="linenos">257</span></a>
</span><span id="OceanSet-258"><a href="#OceanSet-258"><span class="linenos">258</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-259"><a href="#OceanSet-259"><span class="linenos">259</span></a>    <span class="k">def</span> <span class="nf">gohc_TOA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-260"><a href="#OceanSet-260"><span class="linenos">260</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="OceanSet-261"><a href="#OceanSet-261"><span class="linenos">261</span></a>                         <span class="s1">&#39;gohc&#39;</span><span class="p">,</span><span class="s1">&#39;Global ocean heat content wrt to TOA area&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span>
</span><span id="OceanSet-262"><a href="#OceanSet-262"><span class="linenos">262</span></a>    
</span><span id="OceanSet-263"><a href="#OceanSet-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">ohc_above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
</span><span id="OceanSet-264"><a href="#OceanSet-264"><span class="linenos">264</span></a>        <span class="n">res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">heat</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">above</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="OceanSet-265"><a href="#OceanSet-265"><span class="linenos">265</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="o">!=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="OceanSet-266"><a href="#OceanSet-266"><span class="linenos">266</span></a>            <span class="s1">&#39;ohc_above&#39;</span><span class="p">,</span><span class="s1">&#39;Ocean heat content&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span> <span class="c1"># [J/m²]</span>
</span><span id="OceanSet-267"><a href="#OceanSet-267"><span class="linenos">267</span></a>        
</span><span id="OceanSet-268"><a href="#OceanSet-268"><span class="linenos">268</span></a>    <span class="k">def</span> <span class="nf">gohc_above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="OceanSet-269"><a href="#OceanSet-269"><span class="linenos">269</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc_above</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="n">na_eq_zero</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">),</span>
</span><span id="OceanSet-270"><a href="#OceanSet-270"><span class="linenos">270</span></a>                         <span class="s1">&#39;gohc_above&#39;</span><span class="p">,</span><span class="s1">&#39;Global ocean heat content above target&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span>
</span><span id="OceanSet-271"><a href="#OceanSet-271"><span class="linenos">271</span></a>
</span><span id="OceanSet-272"><a href="#OceanSet-272"><span class="linenos">272</span></a>
</span><span id="OceanSet-273"><a href="#OceanSet-273"><span class="linenos">273</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-274"><a href="#OceanSet-274"><span class="linenos">274</span></a>    <span class="k">def</span> <span class="nf">ocean_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-275"><a href="#OceanSet-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth_</span><span class="p">):</span>
</span><span id="OceanSet-276"><a href="#OceanSet-276"><span class="linenos">276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth_</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="OceanSet-277"><a href="#OceanSet-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth_</span>
</span><span id="OceanSet-278"><a href="#OceanSet-278"><span class="linenos">278</span></a>        
</span><span id="OceanSet-279"><a href="#OceanSet-279"><span class="linenos">279</span></a>        
</span><span id="OceanSet-280"><a href="#OceanSet-280"><span class="linenos">280</span></a>    <span class="c1"># Profondeur de l&#39;Ocean Mixed Layer definie par une variation de temperature potentielle de 0.2°C par rapport à -10m</span>
</span><span id="OceanSet-281"><a href="#OceanSet-281"><span class="linenos">281</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-282"><a href="#OceanSet-282"><span class="linenos">282</span></a>    <span class="k">def</span> <span class="nf">mld_theta0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-283"><a href="#OceanSet-283"><span class="linenos">283</span></a>
</span><span id="OceanSet-284"><a href="#OceanSet-284"><span class="linenos">284</span></a>        <span class="n">theta0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
</span><span id="OceanSet-285"><a href="#OceanSet-285"><span class="linenos">285</span></a>        <span class="n">mld1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">theta0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="p">,</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="OceanSet-286"><a href="#OceanSet-286"><span class="linenos">286</span></a>        <span class="n">mld2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">theta0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="p">,</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="OceanSet-287"><a href="#OceanSet-287"><span class="linenos">287</span></a>        <span class="n">mld1</span><span class="o">=</span><span class="n">mld1</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mld2</span><span class="p">)</span>
</span><span id="OceanSet-288"><a href="#OceanSet-288"><span class="linenos">288</span></a>        <span class="n">mld2</span><span class="o">=</span><span class="n">mld2</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mld1</span><span class="p">)</span>
</span><span id="OceanSet-289"><a href="#OceanSet-289"><span class="linenos">289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mld_theta0_</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mld2</span><span class="o">&lt;</span><span class="n">mld1</span><span class="p">,</span><span class="n">mld2</span><span class="p">,</span><span class="n">mld1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OMLD_theta0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth</span><span class="p">)</span>
</span><span id="OceanSet-290"><a href="#OceanSet-290"><span class="linenos">290</span></a>        
</span><span id="OceanSet-291"><a href="#OceanSet-291"><span class="linenos">291</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mld_theta0_</span>
</span><span id="OceanSet-292"><a href="#OceanSet-292"><span class="linenos">292</span></a>
</span><span id="OceanSet-293"><a href="#OceanSet-293"><span class="linenos">293</span></a>    <span class="c1"># Profondeur de l&#39;Ocean Mixed Layer definie par une diminution de temperature potentielle de 0.2°C par rapport à -10m</span>
</span><span id="OceanSet-294"><a href="#OceanSet-294"><span class="linenos">294</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-295"><a href="#OceanSet-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">mld_theta0minus_only</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-296"><a href="#OceanSet-296"><span class="linenos">296</span></a>
</span><span id="OceanSet-297"><a href="#OceanSet-297"><span class="linenos">297</span></a>        <span class="n">theta0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
</span><span id="OceanSet-298"><a href="#OceanSet-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mld_theta0_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PT</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">theta0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="p">,</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
</span><span id="OceanSet-299"><a href="#OceanSet-299"><span class="linenos">299</span></a>            <span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OMLD_theta0minus_only&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth</span><span class="p">)</span>
</span><span id="OceanSet-300"><a href="#OceanSet-300"><span class="linenos">300</span></a>        
</span><span id="OceanSet-301"><a href="#OceanSet-301"><span class="linenos">301</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mld_theta0_</span>
</span><span id="OceanSet-302"><a href="#OceanSet-302"><span class="linenos">302</span></a>    
</span><span id="OceanSet-303"><a href="#OceanSet-303"><span class="linenos">303</span></a>    <span class="c1"># Profondeur de l&#39;Ocean Mixed Layer definie par une augmentation de densité potentielle de 0.03kg/m3 par rapport à -10m</span>
</span><span id="OceanSet-304"><a href="#OceanSet-304"><span class="linenos">304</span></a>    <span class="nd">@property</span>    
</span><span id="OceanSet-305"><a href="#OceanSet-305"><span class="linenos">305</span></a>    <span class="k">def</span> <span class="nf">mld_sigma0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-306"><a href="#OceanSet-306"><span class="linenos">306</span></a>
</span><span id="OceanSet-307"><a href="#OceanSet-307"><span class="linenos">307</span></a>        <span class="n">sigma0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>
</span><span id="OceanSet-308"><a href="#OceanSet-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mld_sigma0_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">sigma0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_sigma0_threshold</span><span class="p">,</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
</span><span id="OceanSet-309"><a href="#OceanSet-309"><span class="linenos">309</span></a>            <span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OMLD_sigma0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth</span><span class="p">)</span>
</span><span id="OceanSet-310"><a href="#OceanSet-310"><span class="linenos">310</span></a>        
</span><span id="OceanSet-311"><a href="#OceanSet-311"><span class="linenos">311</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mld_sigma0_</span>
</span><span id="OceanSet-312"><a href="#OceanSet-312"><span class="linenos">312</span></a>    
</span><span id="OceanSet-313"><a href="#OceanSet-313"><span class="linenos">313</span></a>    <span class="c1"># Profondeur de l&#39;Ocean Mixed Layer definie par une augmentation de densité potentielle correspondant à -0.2°C par rapport à -10m</span>
</span><span id="OceanSet-314"><a href="#OceanSet-314"><span class="linenos">314</span></a>    <span class="nd">@property</span>
</span><span id="OceanSet-315"><a href="#OceanSet-315"><span class="linenos">315</span></a>    <span class="k">def</span> <span class="nf">mld_sigma0var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanSet-316"><a href="#OceanSet-316"><span class="linenos">316</span></a>        <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="OceanSet-317"><a href="#OceanSet-317"><span class="linenos">317</span></a>        <span class="n">ref</span><span class="p">[</span><span class="s1">&#39;PT&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ref</span><span class="p">[</span><span class="s1">&#39;PT&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span>
</span><span id="OceanSet-318"><a href="#OceanSet-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mld_sigma0var_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">isosurface</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">sigma0</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">),</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span>\
</span><span id="OceanSet-319"><a href="#OceanSet-319"><span class="linenos">319</span></a>            <span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OMLD_sigma0var&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_depth</span><span class="p">)</span>
</span><span id="OceanSet-320"><a href="#OceanSet-320"><span class="linenos">320</span></a>        
</span><span id="OceanSet-321"><a href="#OceanSet-321"><span class="linenos">321</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mld_sigma0var_</span>
</span></pre></div>


            <div class="docstring"><p>This class extends any dataset to a xOcean object, that allows to access to any TEOS10 variable simply by calling the name of the variable through the xOcean interface.
The initial dataset must contains the fields necessary to compute the output variable (ex : temperature and salinity to compute heat, heat to compute ohc,...)</p>

<h2 id="availabe-fields">Availabe fields</h2>

<p>Temperatures : one of the three types of temperature must be present in the original dataset to perform derived computation.
    temp  : in-situ temperature <br />
    PT    : potential temperature <br />
    CT    : conservative temperature </p>

<p>Salinities :  one of the three types of salinities must be present in the original dataset to perform derived computation.
    psal  : practical salinity <br />
    SR    : relative salinity <br />
    SA    : absolute salinity. If there is no location information (lat,lon), absolute salinity is returned equal to relative salinity</p>

<p>Physical properties :
    P     : pressure. If location information is present, pressure is adjusted with regard to latitude, otherwise latitude is equal to 0
    Cp    : heat capacity
    rho   : density
    sigma0: potential density anomaly at 0 dbar</p>

<p>Heat content :
    heat  : specific heat content (J/m3)
    ohc   : local ocean heat content (J/m²), it is heat integrated over the whole ocean depth
    gohc  : global ocean heat content (J/m²), it is ohc averaged over latitude-longitude, excluding continents
    gohc_TOA: idem gohc, including continents (where ohc=0)
    ohc_above: idem ohc, where heat is integrated above a given depth
    gohc_above: idem gohc, averaging ohc_above instead of ohc</p>

<p>Sea level :
    slh   : steric sea layer height anomaly (-), equal to (1. - rho/rhoref)
    ssl   : steric sea surface level anomaly (m), it is slh integrated over the whole ocean depth
    ieeh  : integrated expansion efficiency oh heat (m/(J/m²)), it is (ssl/ohc)</p>

<p>Layer depth :
    ocean_depth  : maximum depth with non Nan values for temperature
    mld_theta0   : ocean mixed layer depth, defined by a temperature drop from 0.2°C wrt to -10m depth 
    mld_sigma0   : ocean mixed layer depth, defined by a potential density increase of 0.03kg/m3 wrt to -10m depth
    mld_sigma0var: ocean mixed layer depth, defined by a potential density equal to the potential density at -10m depth with a temperature dropped by 0.2°C</p>

<h2 id="examples">Examples</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data=IAP('/home/usr/lenapy/data/IAP')
      print(data)
      <xarray.Dataset>
      Dimensions:    (latitude: 180, longitude: 360, time: 156, depth: 41)
      Coordinates:</p>
      
      <ul>
      <li>latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</li>
      <li>longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</li>
      <li>time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</li>
      <li>depth      (depth) float32 1.0 5.0 10.0 20.0 ... 1.7e+03 1.8e+03 2e+03
      Data variables:
      temp       (time, latitude, longitude, depth) float32 dask.array<chunksize=(1, 180, 360, 10), meta=np.ndarray>
      SA         (time, latitude, longitude, depth) float32 dask.array<chunksize=(1, 180, 360, 10), meta=np.ndarray>
      mld=data.xocean.mld_sigma0
      print(data.xocean.ohc_above(mld))
      <xarray.DataArray 'ohc_above' (time: 156, latitude: 180, longitude: 360)&gt;
      dask.array<where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray>
      Coordinates:
      depth      (time, latitude, longitude) float64 dask.array<chunksize=(1, 180, 360), meta=np.ndarray></li>
      <li>time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</li>
      <li>latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</li>
      <li>longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0
      Attributes:
      long_name:  Ocean heat content
      units:      J/m²
      print(data.xocean.gohc)
      <xarray.DataArray 'gohc' (time: 156)&gt;
      dask.array<truediv, shape=(156,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray>
      Coordinates:</li>
      <li>time     (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15
      depth    float32 1.0
      Attributes:
      long_name:  Global ocean heat content wrt to ocean surface area
      units:      J/m²</li>
      </ul>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            <div id="OceanSet.__init__" class="classattr">
                                        <input id="OceanSet.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">OceanSet</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">xarray_obj</span></span>)</span>

                <label class="view-source-button" for="OceanSet.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanSet.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanSet.__init__-99"><a href="#OceanSet.__init__-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="OceanSet.__init__-100"><a href="#OceanSet.__init__-100"><span class="linenos">100</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">)</span>
</span><span id="OceanSet.__init__-101"><a href="#OceanSet.__init__-101"><span class="linenos">101</span></a>        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="s1">&#39;PT&#39;</span><span class="p">,</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span><span class="s1">&#39;psal&#39;</span><span class="p">,</span><span class="s1">&#39;SA&#39;</span><span class="p">,</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;sigma0&#39;</span><span class="p">,</span><span class="s1">&#39;Cp&#39;</span><span class="p">,</span><span class="s1">&#39;heat&#39;</span><span class="p">,</span><span class="s1">&#39;slh&#39;</span><span class="p">,</span><span class="s1">&#39;ohc&#39;</span><span class="p">,</span><span class="s1">&#39;ssl&#39;</span><span class="p">,</span><span class="s1">&#39;ieeh&#39;</span><span class="p">,</span><span class="s1">&#39;gohc&#39;</span><span class="p">,</span><span class="s1">&#39;eeh&#39;</span><span class="p">,</span>
</span><span id="OceanSet.__init__-102"><a href="#OceanSet.__init__-102"><span class="linenos">102</span></a>                <span class="s1">&#39;ocean_depth&#39;</span><span class="p">,</span><span class="s1">&#39;mld_theta0&#39;</span><span class="p">,</span><span class="s1">&#39;mld_sigma0&#39;</span><span class="p">,</span><span class="s1">&#39;mld_sigma0var&#39;</span><span class="p">]</span>
</span><span id="OceanSet.__init__-103"><a href="#OceanSet.__init__-103"><span class="linenos">103</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
</span><span id="OceanSet.__init__-104"><a href="#OceanSet.__init__-104"><span class="linenos">104</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">,</span><span class="n">f</span><span class="p">):</span>
</span><span id="OceanSet.__init__-105"><a href="#OceanSet.__init__-105"><span class="linenos">105</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="n">xarray_obj</span><span class="p">[</span><span class="n">f</span><span class="p">])</span>
</span><span id="OceanSet.__init__-106"><a href="#OceanSet.__init__-106"><span class="linenos">106</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="OceanSet.__init__-107"><a href="#OceanSet.__init__-107"><span class="linenos">107</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
</span><span id="OceanSet.__init__-108"><a href="#OceanSet.__init__-108"><span class="linenos">108</span></a>                
</span><span id="OceanSet.__init__-109"><a href="#OceanSet.__init__-109"><span class="linenos">109</span></a>        <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heat_</span><span class="p">):</span>
</span><span id="OceanSet.__init__-110"><a href="#OceanSet.__init__-110"><span class="linenos">110</span></a>            <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CT_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PT_</span><span class="p">):</span>
</span><span id="OceanSet.__init__-111"><a href="#OceanSet.__init__-111"><span class="linenos">111</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;At least one temperature must be set (temp, CT or PT)&#39;</span><span class="p">)</span>
</span><span id="OceanSet.__init__-112"><a href="#OceanSet.__init__-112"><span class="linenos">112</span></a>            <span class="k">if</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SA_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SR_</span><span class="p">)</span> <span class="ow">and</span> <span class="n">NoneType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psal_</span><span class="p">):</span>
</span><span id="OceanSet.__init__-113"><a href="#OceanSet.__init__-113"><span class="linenos">113</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;At least one salinity must be set (psal, SA or SR)&#39;</span><span class="p">)</span>
</span><span id="OceanSet.__init__-114"><a href="#OceanSet.__init__-114"><span class="linenos">114</span></a>
</span><span id="OceanSet.__init__-115"><a href="#OceanSet.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">oml_theta0_threshold</span><span class="o">=</span><span class="mf">0.2</span>
</span><span id="OceanSet.__init__-116"><a href="#OceanSet.__init__-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">oml_sigma0_threshold</span><span class="o">=</span><span class="mf">0.03</span>
</span></pre></div>


    

                            </div>
                            <div id="OceanSet.oml_theta0_threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">oml_theta0_threshold</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.oml_theta0_threshold"></a>
    
    

                            </div>
                            <div id="OceanSet.oml_sigma0_threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">oml_sigma0_threshold</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.oml_sigma0_threshold"></a>
    
    

                            </div>
                            <div id="OceanSet.temp" class="classattr">
                                <div class="attr variable">
            <span class="name">temp</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.temp"></a>
    
    

                            </div>
                            <div id="OceanSet.PT" class="classattr">
                                <div class="attr variable">
            <span class="name">PT</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.PT"></a>
    
    

                            </div>
                            <div id="OceanSet.CT" class="classattr">
                                <div class="attr variable">
            <span class="name">CT</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.CT"></a>
    
    

                            </div>
                            <div id="OceanSet.psal" class="classattr">
                                <div class="attr variable">
            <span class="name">psal</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.psal"></a>
    
    

                            </div>
                            <div id="OceanSet.SR" class="classattr">
                                <div class="attr variable">
            <span class="name">SR</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.SR"></a>
    
    

                            </div>
                            <div id="OceanSet.SA" class="classattr">
                                <div class="attr variable">
            <span class="name">SA</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.SA"></a>
    
    

                            </div>
                            <div id="OceanSet.P" class="classattr">
                                <div class="attr variable">
            <span class="name">P</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.P"></a>
    
    

                            </div>
                            <div id="OceanSet.rho" class="classattr">
                                <div class="attr variable">
            <span class="name">rho</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.rho"></a>
    
    

                            </div>
                            <div id="OceanSet.sigma0" class="classattr">
                                <div class="attr variable">
            <span class="name">sigma0</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.sigma0"></a>
    
    

                            </div>
                            <div id="OceanSet.Cp" class="classattr">
                                <div class="attr variable">
            <span class="name">Cp</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.Cp"></a>
    
    

                            </div>
                            <div id="OceanSet.heat" class="classattr">
                                <div class="attr variable">
            <span class="name">heat</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.heat"></a>
    
    

                            </div>
                            <div id="OceanSet.slh" class="classattr">
                                <div class="attr variable">
            <span class="name">slh</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.slh"></a>
    
    

                            </div>
                            <div id="OceanSet.ohc" class="classattr">
                                <div class="attr variable">
            <span class="name">ohc</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.ohc"></a>
    
    

                            </div>
                            <div id="OceanSet.ssl" class="classattr">
                                <div class="attr variable">
            <span class="name">ssl</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.ssl"></a>
    
    

                            </div>
                            <div id="OceanSet.ieeh" class="classattr">
                                <div class="attr variable">
            <span class="name">ieeh</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.ieeh"></a>
    
    

                            </div>
                            <div id="OceanSet.gohc" class="classattr">
                                <div class="attr variable">
            <span class="name">gohc</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.gohc"></a>
    
    

                            </div>
                            <div id="OceanSet.gohc_TOA" class="classattr">
                                <div class="attr variable">
            <span class="name">gohc_TOA</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.gohc_TOA"></a>
    
    

                            </div>
                            <div id="OceanSet.ohc_above" class="classattr">
                                        <input id="OceanSet.ohc_above-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ohc_above</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="OceanSet.ohc_above-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanSet.ohc_above"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanSet.ohc_above-263"><a href="#OceanSet.ohc_above-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">ohc_above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
</span><span id="OceanSet.ohc_above-264"><a href="#OceanSet.ohc_above-264"><span class="linenos">264</span></a>        <span class="n">res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">heat</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">above</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="OceanSet.ohc_above-265"><a href="#OceanSet.ohc_above-265"><span class="linenos">265</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="o">!=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="OceanSet.ohc_above-266"><a href="#OceanSet.ohc_above-266"><span class="linenos">266</span></a>            <span class="s1">&#39;ohc_above&#39;</span><span class="p">,</span><span class="s1">&#39;Ocean heat content&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span> <span class="c1"># [J/m²]</span>
</span></pre></div>


    

                            </div>
                            <div id="OceanSet.gohc_above" class="classattr">
                                        <input id="OceanSet.gohc_above-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">gohc_above</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span>, </span><span class="param"><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">mask</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="OceanSet.gohc_above-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanSet.gohc_above"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanSet.gohc_above-268"><a href="#OceanSet.gohc_above-268"><span class="linenos">268</span></a>    <span class="k">def</span> <span class="nf">gohc_above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="OceanSet.gohc_above-269"><a href="#OceanSet.gohc_above-269"><span class="linenos">269</span></a>        <span class="k">return</span> <span class="n">proprietes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ohc_above</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="n">na_eq_zero</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">),</span>
</span><span id="OceanSet.gohc_above-270"><a href="#OceanSet.gohc_above-270"><span class="linenos">270</span></a>                         <span class="s1">&#39;gohc_above&#39;</span><span class="p">,</span><span class="s1">&#39;Global ocean heat content above target&#39;</span><span class="p">,</span><span class="s1">&#39;J/m²&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="OceanSet.ocean_depth" class="classattr">
                                <div class="attr variable">
            <span class="name">ocean_depth</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.ocean_depth"></a>
    
    

                            </div>
                            <div id="OceanSet.mld_theta0" class="classattr">
                                <div class="attr variable">
            <span class="name">mld_theta0</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.mld_theta0"></a>
    
    

                            </div>
                            <div id="OceanSet.mld_theta0minus_only" class="classattr">
                                <div class="attr variable">
            <span class="name">mld_theta0minus_only</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.mld_theta0minus_only"></a>
    
    

                            </div>
                            <div id="OceanSet.mld_sigma0" class="classattr">
                                <div class="attr variable">
            <span class="name">mld_sigma0</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.mld_sigma0"></a>
    
    

                            </div>
                            <div id="OceanSet.mld_sigma0var" class="classattr">
                                <div class="attr variable">
            <span class="name">mld_sigma0var</span>

        
    </div>
    <a class="headerlink" href="#OceanSet.mld_sigma0var"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="xGeo.html#GeoSet">lenapy.xGeo.GeoSet</a></dt>
                                <dd id="OceanSet.climato" class="function"><a href="xGeo.html#GeoSet.climato">climato</a></dd>
                <dd id="OceanSet.mean" class="function"><a href="xGeo.html#GeoSet.mean">mean</a></dd>
                <dd id="OceanSet.sum" class="function"><a href="xGeo.html#GeoSet.sum">sum</a></dd>
                <dd id="OceanSet.isosurface" class="function"><a href="xGeo.html#GeoSet.isosurface">isosurface</a></dd>
                <dd id="OceanSet.regridder" class="function"><a href="xGeo.html#GeoSet.regridder">regridder</a></dd>
                <dd id="OceanSet.regrid" class="function"><a href="xGeo.html#GeoSet.regrid">regrid</a></dd>
                <dd id="OceanSet.filter" class="function"><a href="xGeo.html#GeoSet.filter">filter</a></dd>
                <dd id="OceanSet.interp_time" class="function"><a href="xGeo.html#GeoSet.interp_time">interp_time</a></dd>
                <dd id="OceanSet.to_datetime" class="function"><a href="xGeo.html#GeoSet.to_datetime">to_datetime</a></dd>
                <dd id="OceanSet.fill_time" class="function"><a href="xGeo.html#GeoSet.fill_time">fill_time</a></dd>
                <dd id="OceanSet.surface_cell" class="function"><a href="xGeo.html#GeoSet.surface_cell">surface_cell</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="OceanArray">
                            <input id="OceanArray-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@xr.register_dataarray_accessor(&#39;xocean&#39;)</div>

    <span class="def">class</span>
    <span class="name">OceanArray</span><wbr>(<span class="base"><a href="xGeo.html#GeoArray">lenapy.xGeo.GeoArray</a></span>):

                <label class="view-source-button" for="OceanArray-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanArray"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanArray-324"><a href="#OceanArray-324"><span class="linenos">324</span></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataarray_accessor</span><span class="p">(</span><span class="s2">&quot;xocean&quot;</span><span class="p">)</span>
</span><span id="OceanArray-325"><a href="#OceanArray-325"><span class="linenos">325</span></a><span class="k">class</span> <span class="nc">OceanArray</span><span class="p">(</span><span class="n">xg</span><span class="o">.</span><span class="n">GeoArray</span><span class="p">):</span>
</span><span id="OceanArray-326"><a href="#OceanArray-326"><span class="linenos">326</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="OceanArray-327"><a href="#OceanArray-327"><span class="linenos">327</span></a><span class="sd">    This class extends any dataarray to a xOcean object, to perform specific operations on structured dataarray </span>
</span><span id="OceanArray-328"><a href="#OceanArray-328"><span class="linenos">328</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="OceanArray-329"><a href="#OceanArray-329"><span class="linenos">329</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="OceanArray-330"><a href="#OceanArray-330"><span class="linenos">330</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">)</span>
</span><span id="OceanArray-331"><a href="#OceanArray-331"><span class="linenos">331</span></a>
</span><span id="OceanArray-332"><a href="#OceanArray-332"><span class="linenos">332</span></a>    <span class="k">def</span> <span class="nf">add_value_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="OceanArray-333"><a href="#OceanArray-333"><span class="linenos">333</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="OceanArray-334"><a href="#OceanArray-334"><span class="linenos">334</span></a><span class="sd">        Add a surface layer with a specified value, or the previous upper value</span>
</span><span id="OceanArray-335"><a href="#OceanArray-335"><span class="linenos">335</span></a><span class="sd">        Parameter</span>
</span><span id="OceanArray-336"><a href="#OceanArray-336"><span class="linenos">336</span></a><span class="sd">        ---------</span>
</span><span id="OceanArray-337"><a href="#OceanArray-337"><span class="linenos">337</span></a><span class="sd">        value : float or array-like, optional</span>
</span><span id="OceanArray-338"><a href="#OceanArray-338"><span class="linenos">338</span></a><span class="sd">            values to be added in the surface layer (depth=0). If None, the previous upper value is used to fill the new layer</span>
</span><span id="OceanArray-339"><a href="#OceanArray-339"><span class="linenos">339</span></a><span class="sd">        </span>
</span><span id="OceanArray-340"><a href="#OceanArray-340"><span class="linenos">340</span></a><span class="sd">        Returns</span>
</span><span id="OceanArray-341"><a href="#OceanArray-341"><span class="linenos">341</span></a><span class="sd">        -------</span>
</span><span id="OceanArray-342"><a href="#OceanArray-342"><span class="linenos">342</span></a><span class="sd">        added : DataArray</span>
</span><span id="OceanArray-343"><a href="#OceanArray-343"><span class="linenos">343</span></a><span class="sd">            new dataarray with a extra layer at depth 0 filled with required values</span>
</span><span id="OceanArray-344"><a href="#OceanArray-344"><span class="linenos">344</span></a><span class="sd">            </span>
</span><span id="OceanArray-345"><a href="#OceanArray-345"><span class="linenos">345</span></a><span class="sd">        Example</span>
</span><span id="OceanArray-346"><a href="#OceanArray-346"><span class="linenos">346</span></a><span class="sd">        -------</span>
</span><span id="OceanArray-347"><a href="#OceanArray-347"><span class="linenos">347</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanArray-348"><a href="#OceanArray-348"><span class="linenos">348</span></a><span class="sd">        &gt;&gt;&gt;heat=data.xocean.heat.xocean.add_value_surface()            </span>
</span><span id="OceanArray-349"><a href="#OceanArray-349"><span class="linenos">349</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="OceanArray-350"><a href="#OceanArray-350"><span class="linenos">350</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
</span><span id="OceanArray-351"><a href="#OceanArray-351"><span class="linenos">351</span></a>            <span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="OceanArray-352"><a href="#OceanArray-352"><span class="linenos">352</span></a>            <span class="n">v0</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">v0</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span>
</span><span id="OceanArray-353"><a href="#OceanArray-353"><span class="linenos">353</span></a>            <span class="k">if</span> <span class="n">value</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
</span><span id="OceanArray-354"><a href="#OceanArray-354"><span class="linenos">354</span></a>                <span class="n">v0</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span><span id="OceanArray-355"><a href="#OceanArray-355"><span class="linenos">355</span></a>            <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">v0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">],</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="OceanArray-356"><a href="#OceanArray-356"><span class="linenos">356</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="OceanArray-357"><a href="#OceanArray-357"><span class="linenos">357</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
</span><span id="OceanArray-358"><a href="#OceanArray-358"><span class="linenos">358</span></a>                    
</span><span id="OceanArray-359"><a href="#OceanArray-359"><span class="linenos">359</span></a>    <span class="k">def</span> <span class="nf">integ_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanArray-360"><a href="#OceanArray-360"><span class="linenos">360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="OceanArray-361"><a href="#OceanArray-361"><span class="linenos">361</span></a><span class="sd">        Returns the dataarray integrated over the whole depth. The surface value is supposed equal to the most shallow value.</span>
</span><span id="OceanArray-362"><a href="#OceanArray-362"><span class="linenos">362</span></a><span class="sd">        In order to deal with NaN values in deep water during integration,, all NaN are firt converted to 0, then in the output </span>
</span><span id="OceanArray-363"><a href="#OceanArray-363"><span class="linenos">363</span></a><span class="sd">        array NaN values are applied where initial surface values were NaN.</span>
</span><span id="OceanArray-364"><a href="#OceanArray-364"><span class="linenos">364</span></a><span class="sd">        </span>
</span><span id="OceanArray-365"><a href="#OceanArray-365"><span class="linenos">365</span></a><span class="sd">        Example</span>
</span><span id="OceanArray-366"><a href="#OceanArray-366"><span class="linenos">366</span></a><span class="sd">        -------</span>
</span><span id="OceanArray-367"><a href="#OceanArray-367"><span class="linenos">367</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanArray-368"><a href="#OceanArray-368"><span class="linenos">368</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.integ_depth()    </span>
</span><span id="OceanArray-369"><a href="#OceanArray-369"><span class="linenos">369</span></a><span class="sd">        &lt;xarray.DataArray &#39;Heat&#39; (time: 156, latitude: 180, longitude: 360)&gt;</span>
</span><span id="OceanArray-370"><a href="#OceanArray-370"><span class="linenos">370</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;</span>
</span><span id="OceanArray-371"><a href="#OceanArray-371"><span class="linenos">371</span></a><span class="sd">        Coordinates:</span>
</span><span id="OceanArray-372"><a href="#OceanArray-372"><span class="linenos">372</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="OceanArray-373"><a href="#OceanArray-373"><span class="linenos">373</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="OceanArray-374"><a href="#OceanArray-374"><span class="linenos">374</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanArray-375"><a href="#OceanArray-375"><span class="linenos">375</span></a><span class="sd">            depth      float32 1.0</span>
</span><span id="OceanArray-376"><a href="#OceanArray-376"><span class="linenos">376</span></a>
</span><span id="OceanArray-377"><a href="#OceanArray-377"><span class="linenos">377</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="OceanArray-378"><a href="#OceanArray-378"><span class="linenos">378</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
</span><span id="OceanArray-379"><a href="#OceanArray-379"><span class="linenos">379</span></a>    
</span><span id="OceanArray-380"><a href="#OceanArray-380"><span class="linenos">380</span></a>    <span class="k">def</span> <span class="nf">cum_integ_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanArray-381"><a href="#OceanArray-381"><span class="linenos">381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="OceanArray-382"><a href="#OceanArray-382"><span class="linenos">382</span></a><span class="sd">        Returns a cumulative integrated dataarray integrated over the whole depth. The surface value is supposed equal to the </span>
</span><span id="OceanArray-383"><a href="#OceanArray-383"><span class="linenos">383</span></a><span class="sd">        most shallow value. A first integration layer by layer is performed, by multupliying the layer&#39;s thickness by the mean</span>
</span><span id="OceanArray-384"><a href="#OceanArray-384"><span class="linenos">384</span></a><span class="sd">        value of upper and lower bound, then a cumulative sum is computed.</span>
</span><span id="OceanArray-385"><a href="#OceanArray-385"><span class="linenos">385</span></a><span class="sd">        </span>
</span><span id="OceanArray-386"><a href="#OceanArray-386"><span class="linenos">386</span></a><span class="sd">        Example</span>
</span><span id="OceanArray-387"><a href="#OceanArray-387"><span class="linenos">387</span></a><span class="sd">        -------</span>
</span><span id="OceanArray-388"><a href="#OceanArray-388"><span class="linenos">388</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanArray-389"><a href="#OceanArray-389"><span class="linenos">389</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.cum_integ_depth()       </span>
</span><span id="OceanArray-390"><a href="#OceanArray-390"><span class="linenos">390</span></a><span class="sd">        &lt;xarray.DataArray (time: 156, latitude: 180, longitude: 360, depth: 41)&gt;</span>
</span><span id="OceanArray-391"><a href="#OceanArray-391"><span class="linenos">391</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360, 41), dtype=float64, chunksize=(1, 180, 360, 10), chunktype=numpy.ndarray&gt;</span>
</span><span id="OceanArray-392"><a href="#OceanArray-392"><span class="linenos">392</span></a><span class="sd">        Coordinates:</span>
</span><span id="OceanArray-393"><a href="#OceanArray-393"><span class="linenos">393</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="OceanArray-394"><a href="#OceanArray-394"><span class="linenos">394</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="OceanArray-395"><a href="#OceanArray-395"><span class="linenos">395</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanArray-396"><a href="#OceanArray-396"><span class="linenos">396</span></a><span class="sd">          * depth      (depth) float64 1.0 5.0 10.0 20.0 ... 1.7e+03 1.8e+03 2e+03</span>
</span><span id="OceanArray-397"><a href="#OceanArray-397"><span class="linenos">397</span></a>
</span><span id="OceanArray-398"><a href="#OceanArray-398"><span class="linenos">398</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="OceanArray-399"><a href="#OceanArray-399"><span class="linenos">399</span></a>        <span class="n">res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">()</span>  
</span><span id="OceanArray-400"><a href="#OceanArray-400"><span class="linenos">400</span></a>        <span class="n">ep</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="OceanArray-401"><a href="#OceanArray-401"><span class="linenos">401</span></a>        <span class="n">vm</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
</span><span id="OceanArray-402"><a href="#OceanArray-402"><span class="linenos">402</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">vm</span><span class="o">*</span><span class="n">ep</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
</span><span id="OceanArray-403"><a href="#OceanArray-403"><span class="linenos">403</span></a>    
</span><span id="OceanArray-404"><a href="#OceanArray-404"><span class="linenos">404</span></a>    <span class="k">def</span> <span class="nf">above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="OceanArray-405"><a href="#OceanArray-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="OceanArray-406"><a href="#OceanArray-406"><span class="linenos">406</span></a><span class="sd">        Returns the dataarray integrated above a given depth, by interpolating at this depth the cumulative integrale </span>
</span><span id="OceanArray-407"><a href="#OceanArray-407"><span class="linenos">407</span></a><span class="sd">        of the data array</span>
</span><span id="OceanArray-408"><a href="#OceanArray-408"><span class="linenos">408</span></a>
</span><span id="OceanArray-409"><a href="#OceanArray-409"><span class="linenos">409</span></a><span class="sd">        Example</span>
</span><span id="OceanArray-410"><a href="#OceanArray-410"><span class="linenos">410</span></a><span class="sd">        -------</span>
</span><span id="OceanArray-411"><a href="#OceanArray-411"><span class="linenos">411</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanArray-412"><a href="#OceanArray-412"><span class="linenos">412</span></a><span class="sd">        &gt;&gt;&gt;mld=data.xocean.mld_sigma0</span>
</span><span id="OceanArray-413"><a href="#OceanArray-413"><span class="linenos">413</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.above(mld)       </span>
</span><span id="OceanArray-414"><a href="#OceanArray-414"><span class="linenos">414</span></a><span class="sd">        &lt;xarray.DataArray (time: 156, latitude: 180, longitude: 360)&gt;</span>
</span><span id="OceanArray-415"><a href="#OceanArray-415"><span class="linenos">415</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;</span>
</span><span id="OceanArray-416"><a href="#OceanArray-416"><span class="linenos">416</span></a><span class="sd">        Coordinates:</span>
</span><span id="OceanArray-417"><a href="#OceanArray-417"><span class="linenos">417</span></a><span class="sd">            depth      (time, latitude, longitude) float64 dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</span>
</span><span id="OceanArray-418"><a href="#OceanArray-418"><span class="linenos">418</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanArray-419"><a href="#OceanArray-419"><span class="linenos">419</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="OceanArray-420"><a href="#OceanArray-420"><span class="linenos">420</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="OceanArray-421"><a href="#OceanArray-421"><span class="linenos">421</span></a>
</span><span id="OceanArray-422"><a href="#OceanArray-422"><span class="linenos">422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="OceanArray-423"><a href="#OceanArray-423"><span class="linenos">423</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cum_integ_depth</span><span class="p">()</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">interp</span><span class="p">({</span><span class="s1">&#39;depth&#39;</span><span class="p">:</span><span class="n">depth</span><span class="p">},</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This class extends any dataarray to a xOcean object, to perform specific operations on structured dataarray</p>
</div>


                            <div id="OceanArray.__init__" class="classattr">
                                        <input id="OceanArray.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">OceanArray</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">xarray_obj</span></span>)</span>

                <label class="view-source-button" for="OceanArray.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanArray.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanArray.__init__-329"><a href="#OceanArray.__init__-329"><span class="linenos">329</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="OceanArray.__init__-330"><a href="#OceanArray.__init__-330"><span class="linenos">330</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xarray_obj</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="OceanArray.add_value_surface" class="classattr">
                                        <input id="OceanArray.add_value_surface-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_value_surface</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">value</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="OceanArray.add_value_surface-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanArray.add_value_surface"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanArray.add_value_surface-332"><a href="#OceanArray.add_value_surface-332"><span class="linenos">332</span></a>    <span class="k">def</span> <span class="nf">add_value_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="OceanArray.add_value_surface-333"><a href="#OceanArray.add_value_surface-333"><span class="linenos">333</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="OceanArray.add_value_surface-334"><a href="#OceanArray.add_value_surface-334"><span class="linenos">334</span></a><span class="sd">        Add a surface layer with a specified value, or the previous upper value</span>
</span><span id="OceanArray.add_value_surface-335"><a href="#OceanArray.add_value_surface-335"><span class="linenos">335</span></a><span class="sd">        Parameter</span>
</span><span id="OceanArray.add_value_surface-336"><a href="#OceanArray.add_value_surface-336"><span class="linenos">336</span></a><span class="sd">        ---------</span>
</span><span id="OceanArray.add_value_surface-337"><a href="#OceanArray.add_value_surface-337"><span class="linenos">337</span></a><span class="sd">        value : float or array-like, optional</span>
</span><span id="OceanArray.add_value_surface-338"><a href="#OceanArray.add_value_surface-338"><span class="linenos">338</span></a><span class="sd">            values to be added in the surface layer (depth=0). If None, the previous upper value is used to fill the new layer</span>
</span><span id="OceanArray.add_value_surface-339"><a href="#OceanArray.add_value_surface-339"><span class="linenos">339</span></a><span class="sd">        </span>
</span><span id="OceanArray.add_value_surface-340"><a href="#OceanArray.add_value_surface-340"><span class="linenos">340</span></a><span class="sd">        Returns</span>
</span><span id="OceanArray.add_value_surface-341"><a href="#OceanArray.add_value_surface-341"><span class="linenos">341</span></a><span class="sd">        -------</span>
</span><span id="OceanArray.add_value_surface-342"><a href="#OceanArray.add_value_surface-342"><span class="linenos">342</span></a><span class="sd">        added : DataArray</span>
</span><span id="OceanArray.add_value_surface-343"><a href="#OceanArray.add_value_surface-343"><span class="linenos">343</span></a><span class="sd">            new dataarray with a extra layer at depth 0 filled with required values</span>
</span><span id="OceanArray.add_value_surface-344"><a href="#OceanArray.add_value_surface-344"><span class="linenos">344</span></a><span class="sd">            </span>
</span><span id="OceanArray.add_value_surface-345"><a href="#OceanArray.add_value_surface-345"><span class="linenos">345</span></a><span class="sd">        Example</span>
</span><span id="OceanArray.add_value_surface-346"><a href="#OceanArray.add_value_surface-346"><span class="linenos">346</span></a><span class="sd">        -------</span>
</span><span id="OceanArray.add_value_surface-347"><a href="#OceanArray.add_value_surface-347"><span class="linenos">347</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanArray.add_value_surface-348"><a href="#OceanArray.add_value_surface-348"><span class="linenos">348</span></a><span class="sd">        &gt;&gt;&gt;heat=data.xocean.heat.xocean.add_value_surface()            </span>
</span><span id="OceanArray.add_value_surface-349"><a href="#OceanArray.add_value_surface-349"><span class="linenos">349</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="OceanArray.add_value_surface-350"><a href="#OceanArray.add_value_surface-350"><span class="linenos">350</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
</span><span id="OceanArray.add_value_surface-351"><a href="#OceanArray.add_value_surface-351"><span class="linenos">351</span></a>            <span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="OceanArray.add_value_surface-352"><a href="#OceanArray.add_value_surface-352"><span class="linenos">352</span></a>            <span class="n">v0</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">v0</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span>
</span><span id="OceanArray.add_value_surface-353"><a href="#OceanArray.add_value_surface-353"><span class="linenos">353</span></a>            <span class="k">if</span> <span class="n">value</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
</span><span id="OceanArray.add_value_surface-354"><a href="#OceanArray.add_value_surface-354"><span class="linenos">354</span></a>                <span class="n">v0</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</span><span id="OceanArray.add_value_surface-355"><a href="#OceanArray.add_value_surface-355"><span class="linenos">355</span></a>            <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">v0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">],</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="OceanArray.add_value_surface-356"><a href="#OceanArray.add_value_surface-356"><span class="linenos">356</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="OceanArray.add_value_surface-357"><a href="#OceanArray.add_value_surface-357"><span class="linenos">357</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
</span></pre></div>


            <div class="docstring"><p>Add a surface layer with a specified value, or the previous upper value</p>

<h2 id="parameter">Parameter</h2>

<p>value : float or array-like, optional
    values to be added in the surface layer (depth=0). If None, the previous upper value is used to fill the new layer</p>

<h2 id="returns">Returns</h2>

<p>added : DataArray
    new dataarray with a extra layer at depth 0 filled with required values</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data=IAP('/home/usr/lenapy/data/IAP')
      heat=data.xocean.heat.xocean.add_value_surface()</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="OceanArray.integ_depth" class="classattr">
                                        <input id="OceanArray.integ_depth-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">integ_depth</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="OceanArray.integ_depth-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanArray.integ_depth"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanArray.integ_depth-359"><a href="#OceanArray.integ_depth-359"><span class="linenos">359</span></a>    <span class="k">def</span> <span class="nf">integ_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanArray.integ_depth-360"><a href="#OceanArray.integ_depth-360"><span class="linenos">360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="OceanArray.integ_depth-361"><a href="#OceanArray.integ_depth-361"><span class="linenos">361</span></a><span class="sd">        Returns the dataarray integrated over the whole depth. The surface value is supposed equal to the most shallow value.</span>
</span><span id="OceanArray.integ_depth-362"><a href="#OceanArray.integ_depth-362"><span class="linenos">362</span></a><span class="sd">        In order to deal with NaN values in deep water during integration,, all NaN are firt converted to 0, then in the output </span>
</span><span id="OceanArray.integ_depth-363"><a href="#OceanArray.integ_depth-363"><span class="linenos">363</span></a><span class="sd">        array NaN values are applied where initial surface values were NaN.</span>
</span><span id="OceanArray.integ_depth-364"><a href="#OceanArray.integ_depth-364"><span class="linenos">364</span></a><span class="sd">        </span>
</span><span id="OceanArray.integ_depth-365"><a href="#OceanArray.integ_depth-365"><span class="linenos">365</span></a><span class="sd">        Example</span>
</span><span id="OceanArray.integ_depth-366"><a href="#OceanArray.integ_depth-366"><span class="linenos">366</span></a><span class="sd">        -------</span>
</span><span id="OceanArray.integ_depth-367"><a href="#OceanArray.integ_depth-367"><span class="linenos">367</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanArray.integ_depth-368"><a href="#OceanArray.integ_depth-368"><span class="linenos">368</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.integ_depth()    </span>
</span><span id="OceanArray.integ_depth-369"><a href="#OceanArray.integ_depth-369"><span class="linenos">369</span></a><span class="sd">        &lt;xarray.DataArray &#39;Heat&#39; (time: 156, latitude: 180, longitude: 360)&gt;</span>
</span><span id="OceanArray.integ_depth-370"><a href="#OceanArray.integ_depth-370"><span class="linenos">370</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;</span>
</span><span id="OceanArray.integ_depth-371"><a href="#OceanArray.integ_depth-371"><span class="linenos">371</span></a><span class="sd">        Coordinates:</span>
</span><span id="OceanArray.integ_depth-372"><a href="#OceanArray.integ_depth-372"><span class="linenos">372</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="OceanArray.integ_depth-373"><a href="#OceanArray.integ_depth-373"><span class="linenos">373</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="OceanArray.integ_depth-374"><a href="#OceanArray.integ_depth-374"><span class="linenos">374</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanArray.integ_depth-375"><a href="#OceanArray.integ_depth-375"><span class="linenos">375</span></a><span class="sd">            depth      float32 1.0</span>
</span><span id="OceanArray.integ_depth-376"><a href="#OceanArray.integ_depth-376"><span class="linenos">376</span></a>
</span><span id="OceanArray.integ_depth-377"><a href="#OceanArray.integ_depth-377"><span class="linenos">377</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="OceanArray.integ_depth-378"><a href="#OceanArray.integ_depth-378"><span class="linenos">378</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Returns the dataarray integrated over the whole depth. The surface value is supposed equal to the most shallow value.
In order to deal with NaN values in deep water during integration,, all NaN are firt converted to 0, then in the output 
array NaN values are applied where initial surface values were NaN.</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data=IAP('/home/usr/lenapy/data/IAP')
      data.xocean.heat.xocean.integ_depth() <br />
      <xarray.DataArray 'Heat' (time: 156, latitude: 180, longitude: 360)&gt;
      dask.array<where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray>
      Coordinates:</p>
      
      <ul>
      <li>latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</li>
      <li>longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</li>
      <li>time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15
      depth      float32 1.0</li>
      </ul>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="OceanArray.cum_integ_depth" class="classattr">
                                        <input id="OceanArray.cum_integ_depth-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cum_integ_depth</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="OceanArray.cum_integ_depth-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanArray.cum_integ_depth"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanArray.cum_integ_depth-380"><a href="#OceanArray.cum_integ_depth-380"><span class="linenos">380</span></a>    <span class="k">def</span> <span class="nf">cum_integ_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="OceanArray.cum_integ_depth-381"><a href="#OceanArray.cum_integ_depth-381"><span class="linenos">381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="OceanArray.cum_integ_depth-382"><a href="#OceanArray.cum_integ_depth-382"><span class="linenos">382</span></a><span class="sd">        Returns a cumulative integrated dataarray integrated over the whole depth. The surface value is supposed equal to the </span>
</span><span id="OceanArray.cum_integ_depth-383"><a href="#OceanArray.cum_integ_depth-383"><span class="linenos">383</span></a><span class="sd">        most shallow value. A first integration layer by layer is performed, by multupliying the layer&#39;s thickness by the mean</span>
</span><span id="OceanArray.cum_integ_depth-384"><a href="#OceanArray.cum_integ_depth-384"><span class="linenos">384</span></a><span class="sd">        value of upper and lower bound, then a cumulative sum is computed.</span>
</span><span id="OceanArray.cum_integ_depth-385"><a href="#OceanArray.cum_integ_depth-385"><span class="linenos">385</span></a><span class="sd">        </span>
</span><span id="OceanArray.cum_integ_depth-386"><a href="#OceanArray.cum_integ_depth-386"><span class="linenos">386</span></a><span class="sd">        Example</span>
</span><span id="OceanArray.cum_integ_depth-387"><a href="#OceanArray.cum_integ_depth-387"><span class="linenos">387</span></a><span class="sd">        -------</span>
</span><span id="OceanArray.cum_integ_depth-388"><a href="#OceanArray.cum_integ_depth-388"><span class="linenos">388</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanArray.cum_integ_depth-389"><a href="#OceanArray.cum_integ_depth-389"><span class="linenos">389</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.cum_integ_depth()       </span>
</span><span id="OceanArray.cum_integ_depth-390"><a href="#OceanArray.cum_integ_depth-390"><span class="linenos">390</span></a><span class="sd">        &lt;xarray.DataArray (time: 156, latitude: 180, longitude: 360, depth: 41)&gt;</span>
</span><span id="OceanArray.cum_integ_depth-391"><a href="#OceanArray.cum_integ_depth-391"><span class="linenos">391</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360, 41), dtype=float64, chunksize=(1, 180, 360, 10), chunktype=numpy.ndarray&gt;</span>
</span><span id="OceanArray.cum_integ_depth-392"><a href="#OceanArray.cum_integ_depth-392"><span class="linenos">392</span></a><span class="sd">        Coordinates:</span>
</span><span id="OceanArray.cum_integ_depth-393"><a href="#OceanArray.cum_integ_depth-393"><span class="linenos">393</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="OceanArray.cum_integ_depth-394"><a href="#OceanArray.cum_integ_depth-394"><span class="linenos">394</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="OceanArray.cum_integ_depth-395"><a href="#OceanArray.cum_integ_depth-395"><span class="linenos">395</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanArray.cum_integ_depth-396"><a href="#OceanArray.cum_integ_depth-396"><span class="linenos">396</span></a><span class="sd">          * depth      (depth) float64 1.0 5.0 10.0 20.0 ... 1.7e+03 1.8e+03 2e+03</span>
</span><span id="OceanArray.cum_integ_depth-397"><a href="#OceanArray.cum_integ_depth-397"><span class="linenos">397</span></a>
</span><span id="OceanArray.cum_integ_depth-398"><a href="#OceanArray.cum_integ_depth-398"><span class="linenos">398</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="OceanArray.cum_integ_depth-399"><a href="#OceanArray.cum_integ_depth-399"><span class="linenos">399</span></a>        <span class="n">res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">()</span>  
</span><span id="OceanArray.cum_integ_depth-400"><a href="#OceanArray.cum_integ_depth-400"><span class="linenos">400</span></a>        <span class="n">ep</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="OceanArray.cum_integ_depth-401"><a href="#OceanArray.cum_integ_depth-401"><span class="linenos">401</span></a>        <span class="n">vm</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
</span><span id="OceanArray.cum_integ_depth-402"><a href="#OceanArray.cum_integ_depth-402"><span class="linenos">402</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">vm</span><span class="o">*</span><span class="n">ep</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Returns a cumulative integrated dataarray integrated over the whole depth. The surface value is supposed equal to the 
most shallow value. A first integration layer by layer is performed, by multupliying the layer's thickness by the mean
value of upper and lower bound, then a cumulative sum is computed.</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data=IAP('/home/usr/lenapy/data/IAP')
      data.xocean.heat.xocean.cum_integ_depth() <br />
      <xarray.DataArray (time: 156, latitude: 180, longitude: 360, depth: 41)&gt;
      dask.array<where, shape=(156, 180, 360, 41), dtype=float64, chunksize=(1, 180, 360, 10), chunktype=numpy.ndarray>
      Coordinates:</p>
      
      <ul>
      <li>latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</li>
      <li>longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</li>
      <li>time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</li>
      <li>depth      (depth) float64 1.0 5.0 10.0 20.0 ... 1.7e+03 1.8e+03 2e+03</li>
      </ul>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="OceanArray.above" class="classattr">
                                        <input id="OceanArray.above-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">above</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">depth</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="OceanArray.above-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OceanArray.above"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="OceanArray.above-404"><a href="#OceanArray.above-404"><span class="linenos">404</span></a>    <span class="k">def</span> <span class="nf">above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="OceanArray.above-405"><a href="#OceanArray.above-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="OceanArray.above-406"><a href="#OceanArray.above-406"><span class="linenos">406</span></a><span class="sd">        Returns the dataarray integrated above a given depth, by interpolating at this depth the cumulative integrale </span>
</span><span id="OceanArray.above-407"><a href="#OceanArray.above-407"><span class="linenos">407</span></a><span class="sd">        of the data array</span>
</span><span id="OceanArray.above-408"><a href="#OceanArray.above-408"><span class="linenos">408</span></a>
</span><span id="OceanArray.above-409"><a href="#OceanArray.above-409"><span class="linenos">409</span></a><span class="sd">        Example</span>
</span><span id="OceanArray.above-410"><a href="#OceanArray.above-410"><span class="linenos">410</span></a><span class="sd">        -------</span>
</span><span id="OceanArray.above-411"><a href="#OceanArray.above-411"><span class="linenos">411</span></a><span class="sd">        &gt;&gt;&gt;data=IAP(&#39;/home/usr/lenapy/data/IAP&#39;)</span>
</span><span id="OceanArray.above-412"><a href="#OceanArray.above-412"><span class="linenos">412</span></a><span class="sd">        &gt;&gt;&gt;mld=data.xocean.mld_sigma0</span>
</span><span id="OceanArray.above-413"><a href="#OceanArray.above-413"><span class="linenos">413</span></a><span class="sd">        &gt;&gt;&gt;data.xocean.heat.xocean.above(mld)       </span>
</span><span id="OceanArray.above-414"><a href="#OceanArray.above-414"><span class="linenos">414</span></a><span class="sd">        &lt;xarray.DataArray (time: 156, latitude: 180, longitude: 360)&gt;</span>
</span><span id="OceanArray.above-415"><a href="#OceanArray.above-415"><span class="linenos">415</span></a><span class="sd">        dask.array&lt;where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;</span>
</span><span id="OceanArray.above-416"><a href="#OceanArray.above-416"><span class="linenos">416</span></a><span class="sd">        Coordinates:</span>
</span><span id="OceanArray.above-417"><a href="#OceanArray.above-417"><span class="linenos">417</span></a><span class="sd">            depth      (time, latitude, longitude) float64 dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</span>
</span><span id="OceanArray.above-418"><a href="#OceanArray.above-418"><span class="linenos">418</span></a><span class="sd">          * time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</span>
</span><span id="OceanArray.above-419"><a href="#OceanArray.above-419"><span class="linenos">419</span></a><span class="sd">          * latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</span>
</span><span id="OceanArray.above-420"><a href="#OceanArray.above-420"><span class="linenos">420</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</span>
</span><span id="OceanArray.above-421"><a href="#OceanArray.above-421"><span class="linenos">421</span></a>
</span><span id="OceanArray.above-422"><a href="#OceanArray.above-422"><span class="linenos">422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="OceanArray.above-423"><a href="#OceanArray.above-423"><span class="linenos">423</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cum_integ_depth</span><span class="p">()</span><span class="o">.</span><span class="n">xocean</span><span class="o">.</span><span class="n">add_value_surface</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">interp</span><span class="p">({</span><span class="s1">&#39;depth&#39;</span><span class="p">:</span><span class="n">depth</span><span class="p">},</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the dataarray integrated above a given depth, by interpolating at this depth the cumulative integrale 
of the data array</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data=IAP('/home/usr/lenapy/data/IAP')
      mld=data.xocean.mld_sigma0
      data.xocean.heat.xocean.above(mld) <br />
      <xarray.DataArray (time: 156, latitude: 180, longitude: 360)&gt;
      dask.array<where, shape=(156, 180, 360), dtype=float64, chunksize=(1, 180, 360), chunktype=numpy.ndarray>
      Coordinates:
          depth      (time, latitude, longitude) float64 dask.array<chunksize=(1, 180, 360), meta=np.ndarray></p>
      
      <ul>
      <li>time       (time) datetime64[ns] 2005-01-15 2005-02-15 ... 2017-12-15</li>
      <li>latitude   (latitude) float32 -89.5 -88.5 -87.5 -86.5 ... 87.5 88.5 89.5</li>
      <li>longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 357.0 358.0 359.0 360.0</li>
      </ul>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="xGeo.html#GeoArray">lenapy.xGeo.GeoArray</a></dt>
                                <dd id="OceanArray.climato" class="function"><a href="xGeo.html#GeoArray.climato">climato</a></dd>
                <dd id="OceanArray.mean" class="function"><a href="xGeo.html#GeoArray.mean">mean</a></dd>
                <dd id="OceanArray.sum" class="function"><a href="xGeo.html#GeoArray.sum">sum</a></dd>
                <dd id="OceanArray.isosurface" class="function"><a href="xGeo.html#GeoArray.isosurface">isosurface</a></dd>
                <dd id="OceanArray.regridder" class="function"><a href="xGeo.html#GeoArray.regridder">regridder</a></dd>
                <dd id="OceanArray.regrid" class="function"><a href="xGeo.html#GeoArray.regrid">regrid</a></dd>
                <dd id="OceanArray.filter" class="function"><a href="xGeo.html#GeoArray.filter">filter</a></dd>
                <dd id="OceanArray.interp_time" class="function"><a href="xGeo.html#GeoArray.interp_time">interp_time</a></dd>
                <dd id="OceanArray.plot_timeseries_uncertainty" class="function"><a href="xGeo.html#GeoArray.plot_timeseries_uncertainty">plot_timeseries_uncertainty</a></dd>
                <dd id="OceanArray.to_datetime" class="function"><a href="xGeo.html#GeoArray.to_datetime">to_datetime</a></dd>
                <dd id="OceanArray.diff_3pts" class="function"><a href="xGeo.html#GeoArray.diff_3pts">diff_3pts</a></dd>
                <dd id="OceanArray.to_difgri" class="function"><a href="xGeo.html#GeoArray.to_difgri">to_difgri</a></dd>
                <dd id="OceanArray.trend" class="function"><a href="xGeo.html#GeoArray.trend">trend</a></dd>
                <dd id="OceanArray.fill_time" class="function"><a href="xGeo.html#GeoArray.fill_time">fill_time</a></dd>
                <dd id="OceanArray.surface_cell" class="function"><a href="xGeo.html#GeoArray.surface_cell">surface_cell</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>